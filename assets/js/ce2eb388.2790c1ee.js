"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[7557],{2738:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"ros2-fundamentals/services-actions","title":"ROS 2 Services and Actions - Advanced Communication","description":"Learning Objectives","source":"@site/docs/ros2-fundamentals/services-actions.md","sourceDirName":"ros2-fundamentals","slug":"/ros2-fundamentals/services-actions","permalink":"/Physical-Ai-Humanoid-Robotics-Book/docs/ros2-fundamentals/services-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ros2-fundamentals/services-actions.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Packages - Organization and Management","permalink":"/Physical-Ai-Humanoid-Robotics-Book/docs/ros2-fundamentals/packages"},"next":{"title":"Gazebo Fortress Simulation Environment Installation Guide","permalink":"/Physical-Ai-Humanoid-Robotics-Book/docs/simulation/gazebo-installation"}}');var c=i(4848),r=i(7074);const t={sidebar_position:2},l="ROS 2 Services and Actions - Advanced Communication",a={},o=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Conceptual Overview",id:"conceptual-overview",level:2},{value:"Services",id:"services",level:3},{value:"Actions",id:"actions",level:3},{value:"When to Use Each Pattern",id:"when-to-use-each-pattern",level:3},{value:"Hands-On Implementation",id:"hands-on-implementation",level:2},{value:"Services",id:"services-1",level:3},{value:"Service Definition",id:"service-definition",level:4},{value:"Service Server (Python)",id:"service-server-python",level:4},{value:"Service Client (Python)",id:"service-client-python",level:4},{value:"Actions",id:"actions-1",level:3},{value:"Action Definition",id:"action-definition",level:4},{value:"Action Server (Python)",id:"action-server-python",level:4},{value:"Action Client (Python)",id:"action-client-python",level:4},{value:"Creating the Package",id:"creating-the-package",level:3},{value:"Testing &amp; Verification",id:"testing--verification",level:2},{value:"Testing Services",id:"testing-services",level:3},{value:"Testing Actions",id:"testing-actions",level:3},{value:"Useful Commands for Service and Action Inspection",id:"useful-commands-for-service-and-action-inspection",level:3},{value:"Common Issues",id:"common-issues",level:2},{value:"Issue: Service client cannot connect to server",id:"issue-service-client-cannot-connect-to-server",level:3},{value:"Issue: Action client does not receive feedback",id:"issue-action-client-does-not-receive-feedback",level:3},{value:"Issue: Package build fails with service/action definitions",id:"issue-package-build-fails-with-serviceaction-definitions",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"ros-2-services-and-actions---advanced-communication",children:"ROS 2 Services and Actions - Advanced Communication"})}),"\n",(0,c.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,c.jsx)(n.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Understand the differences between topics, services, and actions in ROS 2"}),"\n",(0,c.jsx)(n.li,{children:"Create and use ROS 2 services for request-response communication"}),"\n",(0,c.jsx)(n.li,{children:"Implement ROS 2 actions for goal-oriented, long-running tasks"}),"\n",(0,c.jsx)(n.li,{children:"Design appropriate communication patterns for different use cases"}),"\n",(0,c.jsx)(n.li,{children:"Test and debug service and action implementations"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,c.jsx)(n.p,{children:"Before starting this chapter, you should:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Understand ROS 2 nodes and topics"}),"\n",(0,c.jsx)(n.li,{children:"Have ROS 2 Humble Hawksbill installed and configured"}),"\n",(0,c.jsx)(n.li,{children:"Be familiar with creating ROS 2 packages"}),"\n",(0,c.jsx)(n.li,{children:"Completed the ROS 2 nodes and topics chapter"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"conceptual-overview",children:"Conceptual Overview"}),"\n",(0,c.jsx)(n.p,{children:"In the previous chapter, you learned about topics which use a publish-subscribe communication pattern. While topics are excellent for continuous data streams, many robotics applications require request-response interactions or long-running goal-oriented tasks. This is where services and actions come in."}),"\n",(0,c.jsx)(n.h3,{id:"services",children:"Services"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Services"})," provide a request-response communication pattern where:"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"A client sends a request to a service"}),"\n",(0,c.jsx)(n.li,{children:"The service processes the request and sends back a response"}),"\n",(0,c.jsx)(n.li,{children:"Communication is synchronous from the client's perspective"}),"\n",(0,c.jsx)(n.li,{children:"Services are ideal for operations that have a clear start and end"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"actions",children:"Actions"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Actions"})," are designed for long-running tasks that may:"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Take a significant amount of time to complete"}),"\n",(0,c.jsx)(n.li,{children:"Provide feedback during execution"}),"\n",(0,c.jsx)(n.li,{children:"Be cancelable or preemptable"}),"\n",(0,c.jsx)(n.li,{children:"Report progress and status during execution"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"when-to-use-each-pattern",children:"When to Use Each Pattern"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Topics"}),": Continuous data streams, sensor data, robot state"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Services"}),": Simple request-response tasks, configuration changes, data retrieval"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Actions"}),": Complex tasks with progress, robot navigation, manipulation sequences"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"hands-on-implementation",children:"Hands-On Implementation"}),"\n",(0,c.jsx)(n.h3,{id:"services-1",children:"Services"}),"\n",(0,c.jsx)(n.h4,{id:"service-definition",children:"Service Definition"}),"\n",(0,c.jsxs)(n.p,{children:["First, let's define a simple service. Create a file called ",(0,c.jsx)(n.code,{children:"AddTwoInts.srv"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"int64 a\nint64 b\n---\nint64 sum\n"})}),"\n",(0,c.jsx)(n.p,{children:"This service takes two integers as input and returns their sum."}),"\n",(0,c.jsx)(n.h4,{id:"service-server-python",children:"Service Server (Python)"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Service Server (service_member_function.py):"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n# service_member_function.py\n\n\"\"\"\nThis example demonstrates how to create a simple service server using a class member function to handle\nincoming requests.\n\"\"\"\n\nimport sys\nimport rclpy\nfrom rclpy.node import Node\n\nfrom example_interfaces.srv import AddTwoInts\n\n\nclass MinimalService(Node):\n\n    def __init__(self):\n        super().__init__('minimal_service')\n        # Create a service that will use the callback function to handle requests\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\n\n        return response\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_service = MinimalService()\n\n    rclpy.spin(minimal_service)\n\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,c.jsx)(n.h4,{id:"service-client-python",children:"Service Client (Python)"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Service Client (client_member_function.py):"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n# client_member_function.py\n\n\"\"\"\nThis example demonstrates how to create a simple service client using a class member function to send\nrequests and handle responses.\n\"\"\"\n\nimport sys\nimport rclpy\nfrom rclpy.node import Node\n\nfrom example_interfaces.srv import AddTwoInts\n\n\nclass MinimalClient(Node):\n\n    def __init__(self):\n        super().__init__('minimal_client')\n        # Create a client for the 'add_two_ints' service\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\n\n        # Wait for the service to be available\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n\n        # Create a request\n        self.req = AddTwoInts.Request()\n\n    def send_request(self, a, b):\n        self.req.a = a\n        self.req.b = b\n        # Call the service asynchronously\n        self.future = self.cli.call_async(self.req)\n        rclpy.spin_until_future_complete(self, self.future)\n        return self.future.result()\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_client = MinimalClient()\n    response = minimal_client.send_request(int(sys.argv[1]), int(sys.argv[2]))\n\n    minimal_client.get_logger().info(\n        'Result of add_two_ints: for %d + %d = %d' %\n        (int(sys.argv[1]), int(sys.argv[2]), response.sum))\n\n    minimal_client.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,c.jsx)(n.h3,{id:"actions-1",children:"Actions"}),"\n",(0,c.jsx)(n.h4,{id:"action-definition",children:"Action Definition"}),"\n",(0,c.jsxs)(n.p,{children:["Create an action definition file called ",(0,c.jsx)(n.code,{children:"Fibonacci.action"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"#goal definition\nint32 order\n\n#result definition\nint32[] sequence\n\n#feedback\nint32[] sequence\n"})}),"\n",(0,c.jsx)(n.p,{children:"This action generates a Fibonacci sequence of a given order."}),"\n",(0,c.jsx)(n.h4,{id:"action-server-python",children:"Action Server (Python)"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Action Server (action_server.py):"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\n# action_server.py\n\n"""\nThis example demonstrates how to create a simple action server.\n"""\n\nimport time\nimport rclpy\nfrom rclpy.action import ActionServer, CancelResponse, GoalResponse\nfrom rclpy.callback_groups import ReentrantCallbackGroup\nfrom rclpy.executors import MultiThreadedExecutor\nfrom rclpy.node import Node\n\nfrom example_interfaces.action import Fibonacci\n\n\nclass FibonacciActionServer(Node):\n\n    def __init__(self):\n        super().__init__(\'fibonacci_action_server\')\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            \'fibonacci\',\n            execute_callback=self.execute_callback,\n            callback_group=ReentrantCallbackGroup(),\n            goal_callback=self.goal_callback,\n            cancel_callback=self.cancel_callback)\n\n    def destroy(self):\n        self._action_server.destroy()\n        super().destroy_node()\n\n    def goal_callback(self, goal_request):\n        """Accept or reject a client request to begin an action."""\n        self.get_logger().info(\'Received goal request\')\n        return GoalResponse.ACCEPT\n\n    def cancel_callback(self, goal_handle):\n        """Accept or reject a client request to cancel an action."""\n        self.get_logger().info(\'Received cancel request\')\n        return CancelResponse.ACCEPT\n\n    async def execute_callback(self, goal_handle):\n        """Execute the goal."""\n        self.get_logger().info(\'Executing goal...\')\n\n        # Feedback and result\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n        result = Fibonacci.Result()\n\n        for i in range(1, goal_handle.request.order):\n            # Check if the goal has been canceled\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info(\'Goal canceled\')\n                result.sequence = feedback_msg.sequence\n                return result\n\n            # Update the sequence\n            feedback_msg.sequence.append(feedback_msg.sequence[i] + feedback_msg.sequence[i-1])\n\n            # Publish feedback\n            goal_handle.publish_feedback(feedback_msg)\n            self.get_logger().info(f\'Feedback: {feedback_msg.sequence}\')\n\n            # Simulate work\n            time.sleep(1)\n\n        # Check if the goal was canceled before completing\n        if goal_handle.is_cancel_requested:\n            goal_handle.canceled()\n            self.get_logger().info(\'Goal canceled\')\n            result.sequence = feedback_msg.sequence\n            return result\n\n        # Complete the goal\n        goal_handle.succeed()\n        result.sequence = feedback_msg.sequence\n\n        self.get_logger().info(f\'Result: {result.sequence}\')\n        return result\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    fibonacci_action_server = FibonacciActionServer()\n\n    executor = MultiThreadedExecutor()\n    rclpy.spin(fibonacci_action_server, executor=executor)\n\n    fibonacci_action_server.destroy()\n    rclpy.shutdown()\n\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,c.jsx)(n.h4,{id:"action-client-python",children:"Action Client (Python)"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Action Client (action_client.py):"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n# action_client.py\n\n\"\"\"\nThis example demonstrates how to create a simple action client.\n\"\"\"\n\nimport time\nimport rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.callback_groups import ReentrantCallbackGroup\nfrom rclpy.node import Node\n\nfrom example_interfaces.action import Fibonacci\n\n\nclass FibonacciActionClient(Node):\n\n    def __init__(self):\n        super().__init__('fibonacci_action_client')\n        self._action_client = ActionClient(\n            self,\n            Fibonacci,\n            'fibonacci',\n            callback_group=ReentrantCallbackGroup())\n\n    def send_goal(self, order):\n        # Wait for the action server to be available\n        self.get_logger().info('Waiting for action server...')\n        self._action_client.wait_for_server()\n\n        # Create a goal\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = order\n\n        # Send the goal\n        self.get_logger().info(f'Sending goal: {order}')\n        send_goal_future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback)\n\n        # Wait for the result\n        rclpy.spin_until_future_complete(self, send_goal_future)\n        goal_handle = send_goal_future.result()\n\n        if not goal_handle.accepted:\n            self.get_logger().info('Goal rejected')\n            return\n\n        self.get_logger().info('Goal accepted')\n\n        # Get the result\n        get_result_future = goal_handle.get_result_async()\n        rclpy.spin_until_future_complete(self, get_result_future)\n        result = get_result_future.result().result\n\n        self.get_logger().info(f'Result: {result.sequence}')\n        return result\n\n    def feedback_callback(self, feedback_msg):\n        feedback = feedback_msg.feedback\n        self.get_logger().info(f'Received feedback: {feedback.sequence}')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    action_client = FibonacciActionClient()\n\n    # Send a goal\n    action_client.send_goal(10)\n\n    action_client.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,c.jsx)(n.h3,{id:"creating-the-package",children:"Creating the Package"}),"\n",(0,c.jsx)(n.p,{children:"To create a ROS 2 package for these examples:"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Create the package:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\nros2 pkg create --build-type ament_python py_srvcli\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"2",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Create the service definition directory:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"mkdir -p py_srvcli/py_srvcli\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"3",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Add the Python files to the package:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# Copy service server to py_srvcli/py_srvcli/service_member_function.py\n# Copy service client to py_srvcli/py_srvcli/client_member_function.py\n# Copy action server to py_srvcli/py_srvcli/action_server.py\n# Copy action client to py_srvcli/py_srvcli/action_client.py\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"4",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Make the Python files executable:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"chmod +x py_srvcli/py_srvcli/service_member_function.py\nchmod +x py_srvcli/py_srvcli/client_member_function.py\nchmod +x py_srvcli/py_srvcli/action_server.py\nchmod +x py_srvcli/py_srvcli/action_client.py\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"5",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Update setup.py to include entry points:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"entry_points={\n    'console_scripts': [\n        'add_two_ints_server = py_srvcli.service_member_function:main',\n        'add_two_ints_client = py_srvcli.client_member_function:main',\n        'fibonacci_server = py_srvcli.action_server:main',\n        'fibonacci_client = py_srvcli.action_client:main',\n    ],\n},\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"6",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Build the package:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select py_srvcli\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"7",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Source the workspace:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n",(0,c.jsx)(n.h2,{id:"testing--verification",children:"Testing & Verification"}),"\n",(0,c.jsx)(n.h3,{id:"testing-services",children:"Testing Services"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Open two terminal windows"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"In the first terminal, source your workspace and run the service server:"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\nsource install/setup.bash\nros2 run py_srvcli add_two_ints_server\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"3",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"In the second terminal, source your workspace and run the service client:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\nsource install/setup.bash\nros2 run py_srvcli add_two_ints_client 2 3\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"4",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"You should see the server receive the request and the client get the response:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"[INFO] [1601234567.123456789] [minimal_service]: Incoming request\na: 2 b: 3\n[INFO] [1601234567.123456789] [minimal_client]: Result of add_two_ints: for 2 + 3 = 5\n"})}),"\n",(0,c.jsx)(n.h3,{id:"testing-actions",children:"Testing Actions"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Open two terminal windows"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"In the first terminal, source your workspace and run the action server:"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\nsource install/setup.bash\nros2 run py_srvcli fibonacci_server\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"3",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"In the second terminal, source your workspace and run the action client:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\nsource install/setup.bash\nros2 run py_srvcli fibonacci_client\n"})}),"\n",(0,c.jsxs)(n.ol,{start:"4",children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"You should see feedback during execution and the final result:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"[INFO] [1601234567.123456789] [fibonacci_action_client]: Waiting for action server...\n[INFO] [1601234567.123456789] [fibonacci_action_client]: Sending goal: 10\n[INFO] [1601234567.123456789] [fibonacci_action_client]: Received feedback: [0, 1, 1]\n[INFO] [1601234567.123456789] [fibonacci_action_client]: Received feedback: [0, 1, 1, 2]\n...\n[INFO] [1601234567.123456789] [fibonacci_action_client]: Result: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55]\n"})}),"\n",(0,c.jsx)(n.h3,{id:"useful-commands-for-service-and-action-inspection",children:"Useful Commands for Service and Action Inspection"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"List all services:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"ros2 service list\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Get info about a specific service:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"ros2 service info /add_two_ints\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Call a service directly:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"ros2 service call /add_two_ints example_interfaces/srv/AddTwoInts '{a: 1, b: 2}'\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"List all actions:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"ros2 action list\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"Get info about a specific action:"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"ros2 action info /fibonacci\n"})}),"\n",(0,c.jsx)(n.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,c.jsx)(n.h3,{id:"issue-service-client-cannot-connect-to-server",children:"Issue: Service client cannot connect to server"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Verify the service server is running"}),"\n",(0,c.jsx)(n.li,{children:"Check that service names match exactly"}),"\n",(0,c.jsx)(n.li,{children:"Ensure both nodes are in the same ROS domain"}),"\n",(0,c.jsx)(n.li,{children:"Check network connectivity if nodes are on different machines"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"issue-action-client-does-not-receive-feedback",children:"Issue: Action client does not receive feedback"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Verify the action server is publishing feedback"}),"\n",(0,c.jsx)(n.li,{children:"Check that the action definition matches between client and server"}),"\n",(0,c.jsx)(n.li,{children:"Ensure the action server is not completing too quickly"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"issue-package-build-fails-with-serviceaction-definitions",children:"Issue: Package build fails with service/action definitions"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Make sure to add the correct dependencies in package.xml"}),"\n",(0,c.jsxs)(n.li,{children:["For services: add ",(0,c.jsx)(n.code,{children:"<depend>example_interfaces</depend>"})]}),"\n",(0,c.jsxs)(n.li,{children:["For actions: add ",(0,c.jsx)(n.code,{children:"<depend>example_interfaces</depend>"})]}),"\n",(0,c.jsx)(n.li,{children:"Ensure the correct message types are imported"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Services provide request-response communication, ideal for quick operations"}),"\n",(0,c.jsx)(n.li,{children:"Actions are designed for long-running tasks with feedback and cancellation"}),"\n",(0,c.jsx)(n.li,{children:"Services are synchronous from the client perspective"}),"\n",(0,c.jsx)(n.li,{children:"Actions provide asynchronous communication with progress tracking"}),"\n",(0,c.jsx)(n.li,{children:"Use topics for continuous data streams, services for simple requests, and actions for complex tasks"}),"\n",(0,c.jsx)(n.li,{children:"Both services and actions have built-in tools for inspection and debugging"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,c.jsx)(n.p,{children:"In the next chapter, you'll learn about ROS 2 packages and how to organize your code effectively in the ROS 2 ecosystem."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},7074:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var s=i(6540);const c={},r=s.createContext(c);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);