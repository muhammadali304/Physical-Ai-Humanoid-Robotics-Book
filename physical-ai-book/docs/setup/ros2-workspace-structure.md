# ROS 2 Workspace Structure

This document describes the standard structure for a ROS 2 workspace used in the Physical AI & Humanoid Robotics educational book.

## Workspace Directory Structure

```
~/ros2_ws/                     # Root workspace directory
├── src/                       # Source code directory
│   ├── CMakeLists.txt         # Symlink to /opt/ros/<distro>/share/colcon-core/package_manifests/CMakeLists.txt
│   ├── my_robot_package/      # Example robot package
│   │   ├── CMakeLists.txt     # Build instructions for the package
│   │   ├── package.xml        # Package manifest
│   │   ├── src/               # C++ source files
│   │   ├── include/           # C++ header files
│   │   ├── scripts/           # Executable scripts
│   │   ├── launch/            # Launch files
│   │   ├── config/            # Configuration files
│   │   └── test/              # Test files
│   └── other_packages/        # Additional packages
├── build/                     # Build artifacts (generated by colcon build)
├── install/                   # Installation directory (generated by colcon build)
│   ├── lib/                   # Libraries
│   ├── share/                 # Shared resources
│   └── setup.bash             # Environment setup script
└── log/                       # Build logs
```

## Creating a New Package

To create a new ROS 2 package in your workspace:

```bash
cd ~/ros2_ws/src
ros2 pkg create --build-type ament_cmake --dependencies rclcpp rclpy std_msgs geometry_msgs <package_name>
```

## Building the Workspace

```bash
cd ~/ros2_ws
colcon build --packages-select <package_name>
# or build all packages
colcon build
```

## Sourcing the Workspace

After building, source the workspace:

```bash
source ~/ros2_ws/install/setup.bash
```

To automatically source the workspace, add to your `~/.bashrc`:

```bash
echo "source ~/ros2_ws/install/setup.bash" >> ~/.bashrc
```

## Package Manifest (package.xml)

Each package requires a `package.xml` file that describes the package and its dependencies:

```xml
<?xml version="1.0"?>
<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>
<package format="3">
  <name>my_robot_package</name>
  <version>0.0.0</version>
  <description>Example robot package for Physical AI & Humanoid Robotics</description>
  <maintainer email="user@example.com">Your Name</maintainer>
  <license>Apache License 2.0</license>

  <buildtool_depend>ament_cmake</buildtool_depend>

  <depend>rclcpp</depend>
  <depend>rclpy</depend>
  <depend>std_msgs</depend>
  <depend>geometry_msgs</depend>

  <test_depend>ament_lint_auto</test_depend>
  <test_depend>ament_lint_common</test_depend>

  <export>
    <build_type>ament_cmake</build_type>
  </export>
</package>
```

## CMakeLists.txt Template

Basic CMakeLists.txt for a ROS 2 package:

```cmake
cmake_minimum_required(VERSION 3.8)
project(my_robot_package)

if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")
  add_compile_options(-Wall -Wextra -Wpedantic)
endif()

# find dependencies
find_package(ament_cmake REQUIRED)
find_package(rclcpp REQUIRED)
find_package(rclpy REQUIRED)
find_package(std_msgs REQUIRED)
find_package(geometry_msgs REQUIRED)

# uncomment the following section in order to fill in
# further dependencies manually.
# find_package(<dependency> REQUIRED)

if(BUILD_TESTING)
  find_package(ament_lint_auto REQUIRED)
  # the following line skips the linter which checks for copyrights
  # comment the line when a copyright and license is added to all source files
  set(ament_cmake_copyright_FOUND TRUE)
  # the following line skips cpplint (only works in a git repo)
  # comment the line when this package is in a git repo and when
  # a copyright and license is added to all source files
  set(ament_cmake_cpplint_FOUND TRUE)
  ament_lint_auto_find_test_dependencies()
endif()

ament_package()
```

## Best Practices

1. **Package Naming**: Use snake_case for package names
2. **Dependencies**: List all dependencies in package.xml
3. **Source Control**: Add `build/`, `install/`, and `log/` to `.gitignore`
4. **Documentation**: Include README.md in each package
5. **Testing**: Include unit tests in the package