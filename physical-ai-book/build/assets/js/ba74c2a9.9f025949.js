"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[192],{2542:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>t,default:()=>m,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"isaac-platform/costmap-configuration","title":"Costmap Configuration for Obstacle Avoidance","description":"Overview","source":"@site/docs/isaac-platform/costmap-configuration.md","sourceDirName":"isaac-platform","slug":"/isaac-platform/costmap-configuration","permalink":"/docs/isaac-platform/costmap-configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/isaac-platform/costmap-configuration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Robot Localization System Using AMCL","permalink":"/docs/isaac-platform/robot-localization-amcl"},"next":{"title":"Path Planning Algorithms Implementation","permalink":"/docs/isaac-platform/path-planning-algorithms"}}');var s=a(4848),o=a(7074);const i={},t="Costmap Configuration for Obstacle Avoidance",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Understanding Costmaps",id:"understanding-costmaps",level:2},{value:"What are Costmaps?",id:"what-are-costmaps",level:3},{value:"Types of Costmaps",id:"types-of-costmaps",level:3},{value:"Costmap Configuration",id:"costmap-configuration",level:2},{value:"1. Basic Costmap Configuration",id:"1-basic-costmap-configuration",level:3},{value:"2. Advanced Costmap Configuration for Complex Environments",id:"2-advanced-costmap-configuration-for-complex-environments",level:3},{value:"Costmap Layers Configuration",id:"costmap-layers-configuration",level:2},{value:"1. Static Layer Configuration",id:"1-static-layer-configuration",level:3},{value:"2. Obstacle Layer Configuration",id:"2-obstacle-layer-configuration",level:3},{value:"3. Inflation Layer Configuration",id:"3-inflation-layer-configuration",level:3},{value:"Costmap Integration with Isaac ROS",id:"costmap-integration-with-isaac-ros",level:2},{value:"1. Perception-Enhanced Costmaps",id:"1-perception-enhanced-costmaps",level:3},{value:"2. Semantic Costmap Configuration",id:"2-semantic-costmap-configuration",level:3},{value:"Costmap Performance Tuning",id:"costmap-performance-tuning",level:2},{value:"1. Performance Optimization Parameters",id:"1-performance-optimization-parameters",level:3},{value:"2. Memory Management",id:"2-memory-management",level:3},{value:"Costmap Troubleshooting",id:"costmap-troubleshooting",level:2},{value:"1. Common Issues and Solutions",id:"1-common-issues-and-solutions",level:3},{value:"Issue: Costmap Not Updating",id:"issue-costmap-not-updating",level:4},{value:"Issue: Poor Obstacle Detection",id:"issue-poor-obstacle-detection",level:4},{value:"Issue: High CPU Usage",id:"issue-high-cpu-usage",level:4},{value:"Issue: Robot Gets Stuck Near Obstacles",id:"issue-robot-gets-stuck-near-obstacles",level:4},{value:"2. Debugging Tools",id:"2-debugging-tools",level:3},{value:"Costmap Visualization",id:"costmap-visualization",level:4},{value:"Costmap Analysis",id:"costmap-analysis",level:4},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Parameter Selection Guidelines",id:"1-parameter-selection-guidelines",level:3},{value:"2. Layer Configuration Best Practices",id:"2-layer-configuration-best-practices",level:3},{value:"3. Performance Optimization",id:"3-performance-optimization",level:3},{value:"Integration with Navigation System",id:"integration-with-navigation-system",level:2},{value:"1. Controller Integration",id:"1-controller-integration",level:3},{value:"2. Planner Integration",id:"2-planner-integration",level:3},{value:"Quality Assurance",id:"quality-assurance",level:2},{value:"1. Costmap Validation",id:"1-costmap-validation",level:3},{value:"2. Safety Validation",id:"2-safety-validation",level:3},{value:"Resources",id:"resources",level:2},{value:"Conclusion",id:"conclusion",level:2}];function p(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"costmap-configuration-for-obstacle-avoidance",children:"Costmap Configuration for Obstacle Avoidance"})}),"\n",(0,s.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(e.p,{children:"This guide provides instructions for configuring costmaps for effective obstacle avoidance in robot navigation. Costmaps are critical components of the Navigation2 stack that represent the environment with different cost values for navigation planning and obstacle avoidance."}),"\n",(0,s.jsx)(e.h2,{id:"understanding-costmaps",children:"Understanding Costmaps"}),"\n",(0,s.jsx)(e.h3,{id:"what-are-costmaps",children:"What are Costmaps?"}),"\n",(0,s.jsx)(e.p,{children:"Costmaps are 2D or 3D representations of the robot's environment where each cell contains a cost value indicating how difficult or dangerous it is for the robot to navigate through that area. Higher cost values represent areas to avoid, while lower values indicate free space."}),"\n",(0,s.jsx)(e.h3,{id:"types-of-costmaps",children:"Types of Costmaps"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Local Costmap"}),": Short-term planning around the robot (typically 3-10 meters)"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Global Costmap"}),": Long-term planning for entire navigation route"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Static Layer"}),": Represents permanent obstacles from the map"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Obstacle Layer"}),": Represents dynamic obstacles from sensors"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Inflation Layer"}),": Expands obstacles to account for robot size and safety margin"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"costmap-configuration",children:"Costmap Configuration"}),"\n",(0,s.jsx)(e.h3,{id:"1-basic-costmap-configuration",children:"1. Basic Costmap Configuration"}),"\n",(0,s.jsxs)(e.p,{children:["Create a comprehensive costmap configuration file ",(0,s.jsx)(e.code,{children:"costmap_config.yaml"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'# Global Costmap Configuration\r\nglobal_costmap:\r\n  global_costmap:\r\n    ros__parameters:\r\n      # Global parameters\r\n      update_frequency: 1.0\r\n      publish_frequency: 1.0\r\n      transform_tolerance: 0.5\r\n      use_sim_time: false\r\n\r\n      # Map parameters\r\n      global_frame: map\r\n      robot_base_frame: base_link\r\n      robot_radius: 0.22  # Radius of the robot in meters\r\n      resolution: 0.05    # Meters per cell\r\n\r\n      # Plugin configuration\r\n      plugins: ["static_layer", "obstacle_layer", "inflation_layer"]\r\n\r\n      # Static layer (from map)\r\n      static_layer:\r\n        plugin: "nav2_costmap_2d::StaticLayer"\r\n        map_subscribe_transient_local: True\r\n        transform_tolerance: 0.5\r\n\r\n      # Obstacle layer (from sensors)\r\n      obstacle_layer:\r\n        plugin: "nav2_costmap_2d::ObstacleLayer"\r\n        enabled: True\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n          raytrace_max_range: 3.0\r\n          raytrace_min_range: 0.0\r\n          obstacle_max_range: 2.5\r\n          obstacle_min_range: 0.0\r\n          inf_is_valid: False\r\n\r\n      # Inflation layer (safety buffer)\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        cost_scaling_factor: 3.0  # Exponential decay factor\r\n        inflation_radius: 0.55    # Maximum inflation distance in meters\r\n        inflate_unknown: False\r\n        inflate_around_unknown: False\r\n\r\n      # Always send full costmap for debugging\r\n      always_send_full_costmap: True\r\n\r\n  # Client parameters for global costmap\r\n  global_costmap_client:\r\n    ros__parameters:\r\n      use_sim_time: false\r\n\r\n  # RCLCPP node parameters\r\n  global_costmap_rclcpp_node:\r\n    ros__parameters:\r\n      use_sim_time: false\r\n\r\n# Local Costmap Configuration\r\nlocal_costmap:\r\n  local_costmap:\r\n    ros__parameters:\r\n      # Local parameters\r\n      update_frequency: 5.0\r\n      publish_frequency: 2.0\r\n      transform_tolerance: 0.5\r\n      use_sim_time: false\r\n\r\n      # Map parameters\r\n      global_frame: odom\r\n      robot_base_frame: base_link\r\n      robot_radius: 0.22\r\n      resolution: 0.05\r\n      track_unknown_space: false\r\n\r\n      # Rolling window for local costmap\r\n      rolling_window: true\r\n      width: 6\r\n      height: 6\r\n      origin_x: 0.0\r\n      origin_y: 0.0\r\n\r\n      # Plugin configuration\r\n      plugins: ["voxel_layer", "inflation_layer"]\r\n\r\n      # Voxel layer for 3D obstacle detection\r\n      voxel_layer:\r\n        plugin: "nav2_costmap_2d::VoxelLayer"\r\n        enabled: True\r\n        publish_voxel_map: True\r\n        origin_z: 0.0\r\n        z_resolution: 0.05\r\n        z_voxels: 16\r\n        max_obstacle_height: 2.0\r\n        mark_threshold: 0\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n          raytrace_max_range: 3.0\r\n          raytrace_min_range: 0.0\r\n          obstacle_max_range: 2.5\r\n          obstacle_min_range: 0.0\r\n\r\n      # Inflation layer for local costmap\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        cost_scaling_factor: 3.0\r\n        inflation_radius: 0.55\r\n        inflate_unknown: False\r\n\r\n      # Always send full costmap\r\n      always_send_full_costmap: True\r\n\r\n  # Client parameters for local costmap\r\n  local_costmap_client:\r\n    ros__parameters:\r\n      use_sim_time: false\r\n\r\n  # RCLCPP node parameters\r\n  local_costmap_rclcpp_node:\r\n    ros__parameters:\r\n      use_sim_time: false\n'})}),"\n",(0,s.jsx)(e.h3,{id:"2-advanced-costmap-configuration-for-complex-environments",children:"2. Advanced Costmap Configuration for Complex Environments"}),"\n",(0,s.jsx)(e.p,{children:"For more complex obstacle avoidance scenarios:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'# Advanced costmap configuration\r\nglobal_costmap:\r\n  global_costmap:\r\n    ros__parameters:\r\n      update_frequency: 0.5  # Slower updates for global map\r\n      publish_frequency: 0.5\r\n      transform_tolerance: 1.0\r\n      use_sim_time: false\r\n\r\n      global_frame: map\r\n      robot_base_frame: base_link\r\n      robot_radius: 0.22\r\n      resolution: 0.025  # Higher resolution for better accuracy\r\n\r\n      plugins: ["static_layer", "obstacle_layer", "inflation_layer", "range_sensor_layer"]\r\n\r\n      static_layer:\r\n        plugin: "nav2_costmap_2d::StaticLayer"\r\n        map_subscribe_transient_local: True\r\n        transform_tolerance: 1.0\r\n        track_unknown_space: True\r\n        use_maximum: True  # Use maximum of static and other layers\r\n\r\n      obstacle_layer:\r\n        plugin: "nav2_costmap_2d::ObstacleLayer"\r\n        enabled: True\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n          raytrace_max_range: 5.0  # Extended range for better planning\r\n          raytrace_min_range: 0.1\r\n          obstacle_max_range: 4.0  # Extended range for obstacle detection\r\n          obstacle_min_range: 0.1\r\n          inf_is_valid: False\r\n          clearing_endpoints: False\r\n\r\n      # Range sensor layer for additional sensor types\r\n      range_sensor_layer:\r\n        plugin: "spatio_temporal_voxel_layer/SpatioTemporalVoxelLayer"\r\n        enabled: True\r\n        voxel_decay: 10.0\r\n        decay_model: 0  # 0=linear, 1=exponential, 2=quadratic\r\n        voxel_size: 0.05\r\n        track_unknown_space: True\r\n        observation_sources: range_sensor\r\n        range_sensor:\r\n          topic: /range/sensor\r\n          sensor_frame: range_sensor_frame\r\n          data_type: "Range"\r\n          clearing: True\r\n          marking: True\r\n\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        enabled: True\r\n        cost_scaling_factor: 5.0  # More aggressive inflation\r\n        inflation_radius: 0.8     # Larger safety margin\r\n        inflate_unknown: False\r\n        inflate_around_unknown: False\r\n\r\n# Advanced local costmap\r\nlocal_costmap:\r\n  local_costmap:\r\n    ros__parameters:\r\n      update_frequency: 10.0  # Faster updates for local planning\r\n      publish_frequency: 5.0\r\n      transform_tolerance: 0.2\r\n      use_sim_time: false\r\n\r\n      global_frame: odom\r\n      robot_base_frame: base_link\r\n      robot_radius: 0.22\r\n      resolution: 0.025  # Higher resolution for local planning\r\n\r\n      rolling_window: true\r\n      width: 8\r\n      height: 8\r\n      origin_x: -4.0\r\n      origin_y: -4.0\r\n\r\n      plugins: ["voxel_layer", "inflation_layer", "dynamic_layer"]\r\n\r\n      voxel_layer:\r\n        plugin: "nav2_costmap_2d::VoxelLayer"\r\n        enabled: True\r\n        publish_voxel_map: True\r\n        origin_z: 0.0\r\n        z_resolution: 0.05\r\n        z_voxels: 16\r\n        max_obstacle_height: 2.0\r\n        mark_threshold: 0\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n          raytrace_max_range: 5.0\r\n          raytrace_min_range: 0.1\r\n          obstacle_max_range: 4.0\r\n          obstacle_min_range: 0.1\r\n\r\n      # Dynamic obstacle layer for moving objects\r\n      dynamic_layer:\r\n        plugin: "nav2_dynamic_obstacles_layer/DynamicObstaclesLayer"\r\n        enabled: True\r\n        observation_sources: dynamic_obs\r\n        dynamic_obs:\r\n          topic: /dynamic_obstacles\r\n          sensor_frame: base_link\r\n          data_type: "PointCloud2"\r\n          clearing: True\r\n          marking: True\r\n\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        enabled: True\r\n        cost_scaling_factor: 8.0  # More aggressive for local planning\r\n        inflation_radius: 0.6\r\n        inflate_unknown: False\n'})}),"\n",(0,s.jsx)(e.h2,{id:"costmap-layers-configuration",children:"Costmap Layers Configuration"}),"\n",(0,s.jsx)(e.h3,{id:"1-static-layer-configuration",children:"1. Static Layer Configuration"}),"\n",(0,s.jsx)(e.p,{children:"The static layer represents permanent obstacles from the known map:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'static_layer:\r\n  plugin: "nav2_costmap_2d::StaticLayer"\r\n  map_subscribe_transient_local: True\r\n  transform_tolerance: 0.5\r\n  track_unknown_space: False\r\n  use_maximum: False\r\n  first_map_only: False\r\n  subscribe_to_updates: False\r\n  map_topic: "map"\r\n  lethal_cost_threshold: 100  # Values >= this are considered obstacles\r\n  unknown_cost_value: -1      # Value for unknown space (-1 = 255 in nav2)\r\n  trinary_costmap: True       # Three values: free, unknown, lethal\n'})}),"\n",(0,s.jsx)(e.h3,{id:"2-obstacle-layer-configuration",children:"2. Obstacle Layer Configuration"}),"\n",(0,s.jsx)(e.p,{children:"The obstacle layer processes sensor data to detect dynamic obstacles:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'obstacle_layer:\r\n  plugin: "nav2_costmap_2d::ObstacleLayer"\r\n  enabled: True\r\n  observation_sources: scan\r\n  scan:\r\n    topic: /scan\r\n    sensor_frame: laser_frame\r\n    max_obstacle_height: 2.0\r\n    clearing: True\r\n    marking: True\r\n    data_type: "LaserScan"\r\n    raytrace_max_range: 3.0\r\n    raytrace_min_range: 0.0\r\n    obstacle_max_range: 2.5\r\n    obstacle_min_range: 0.0\r\n    obstacle_max_height: 2.0\r\n    obstacle_min_height: 0.0\r\n    inf_is_valid: False\r\n    clearing_endpoints: False\r\n    model_type: "beam"\r\n    clearing_threshold: 0.196\r\n    marking_threshold: 0.25\n'})}),"\n",(0,s.jsx)(e.h3,{id:"3-inflation-layer-configuration",children:"3. Inflation Layer Configuration"}),"\n",(0,s.jsx)(e.p,{children:"The inflation layer creates safety margins around obstacles:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'inflation_layer:\r\n  plugin: "nav2_costmap_2d::InflationLayer"\r\n  enabled: True\r\n  cost_scaling_factor: 10.0    # Exponential decay factor (higher = faster decay)\r\n  inflation_radius: 1.0        # Maximum inflation distance\r\n  inflate_unknown: False       # Whether to inflate unknown space\r\n  inflate_around_unknown: False # Whether to inflate around unknown space\r\n  inflate_free_space: False    # Whether to inflate free space\n'})}),"\n",(0,s.jsx)(e.h2,{id:"costmap-integration-with-isaac-ros",children:"Costmap Integration with Isaac ROS"}),"\n",(0,s.jsx)(e.h3,{id:"1-perception-enhanced-costmaps",children:"1. Perception-Enhanced Costmaps"}),"\n",(0,s.jsx)(e.p,{children:"Integrate Isaac ROS perception data into costmaps:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'# Costmap configuration with Isaac ROS perception\r\nglobal_costmap:\r\n  global_costmap:\r\n    ros__parameters:\r\n      plugins: ["static_layer", "obstacle_layer", "isaac_perception_layer", "inflation_layer"]\r\n\r\n      static_layer:\r\n        plugin: "nav2_costmap_2d::StaticLayer"\r\n        map_subscribe_transient_local: True\r\n\r\n      obstacle_layer:\r\n        plugin: "nav2_costmap_2d::ObstacleLayer"\r\n        enabled: True\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n\r\n      # Isaac ROS perception layer\r\n      isaac_perception_layer:\r\n        plugin: "nav2_isaac_perception_layer/IsaacPerceptionLayer"\r\n        enabled: True\r\n        observation_sources: semantic_segmentation\r\n        semantic_segmentation:\r\n          topic: /segmentation/segmentation_map\r\n          sensor_frame: camera_link\r\n          data_type: "Image"\r\n          clearing: False\r\n          marking: True\r\n          obstacle_value: 254  # Value representing obstacles in segmentation\r\n          free_space_value: 0  # Value representing free space\r\n\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        cost_scaling_factor: 5.0\r\n        inflation_radius: 0.8\r\n\r\n# Local costmap with perception\r\nlocal_costmap:\r\n  local_costmap:\r\n    ros__parameters:\r\n      plugins: ["voxel_layer", "isaac_perception_layer", "inflation_layer"]\r\n\r\n      voxel_layer:\r\n        plugin: "nav2_costmap_2d::VoxelLayer"\r\n        enabled: True\r\n        publish_voxel_map: True\r\n        origin_z: 0.0\r\n        z_resolution: 0.05\r\n        z_voxels: 16\r\n        max_obstacle_height: 2.0\r\n        mark_threshold: 0\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n\r\n      isaac_perception_layer:\r\n        plugin: "nav2_isaac_perception_layer/IsaacPerceptionLayer"\r\n        enabled: True\r\n        observation_sources: stereo_depth\r\n        stereo_depth:\r\n          topic: /stereo/depth/disparity\r\n          sensor_frame: stereo_camera_link\r\n          data_type: "Disparity"\r\n          clearing: True\r\n          marking: True\r\n\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        cost_scaling_factor: 8.0\r\n        inflation_radius: 0.6\n'})}),"\n",(0,s.jsx)(e.h3,{id:"2-semantic-costmap-configuration",children:"2. Semantic Costmap Configuration"}),"\n",(0,s.jsx)(e.p,{children:"Use semantic segmentation for intelligent obstacle classification:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'semantic_costmap:\r\n  semantic_costmap:\r\n    ros__parameters:\r\n      plugins: ["semantic_layer", "inflation_layer"]\r\n\r\n      semantic_layer:\r\n        plugin: "nav2_semantic_costmap_layer/SemanticLayer"\r\n        enabled: True\r\n        observation_sources: semantic_input\r\n        semantic_input:\r\n          topic: /semantic_segmentation/output\r\n          sensor_frame: camera_frame\r\n          data_type: "Image"\r\n          clearing: False\r\n          marking: True\r\n          # Semantic class mappings\r\n          class_mappings:\r\n            - {class_id: 0, class_name: "free_space", cost: 0, is_obstacle: false}\r\n            - {class_id: 1, class_name: "wall", cost: 254, is_obstacle: true}\r\n            - {class_id: 2, class_name: "person", cost: 200, is_obstacle: true}\r\n            - {class_id: 3, class_name: "furniture", cost: 254, is_obstacle: true}\r\n            - {class_id: 4, class_name: "plant", cost: 100, is_obstacle: true}\r\n            - {class_id: 5, class_name: "clutter", cost: 150, is_obstacle: true}\r\n\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        cost_scaling_factor: 3.0\r\n        inflation_radius: 0.5\n'})}),"\n",(0,s.jsx)(e.h2,{id:"costmap-performance-tuning",children:"Costmap Performance Tuning"}),"\n",(0,s.jsx)(e.h3,{id:"1-performance-optimization-parameters",children:"1. Performance Optimization Parameters"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'# Optimized costmap configuration for performance\r\nglobal_costmap:\r\n  global_costmap:\r\n    ros__parameters:\r\n      update_frequency: 0.5    # Lower frequency for global map\r\n      publish_frequency: 0.5\r\n      resolution: 0.1          # Lower resolution for performance\r\n      width: 100              # Smaller initial size\r\n      height: 100\r\n      plugins: ["static_layer", "obstacle_layer", "inflation_layer"]\r\n\r\n      # Optimized obstacle layer\r\n      obstacle_layer:\r\n        plugin: "nav2_costmap_2d::ObstacleLayer"\r\n        enabled: True\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n          raytrace_max_range: 10.0  # Reduce range if not needed\r\n          obstacle_max_range: 8.0\r\n          observation_persistence: 0.0  # Process immediately\r\n\r\n      # Optimized inflation\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        cost_scaling_factor: 3.0\r\n        inflation_radius: 0.5  # Smaller radius for performance\r\n\r\nlocal_costmap:\r\n  local_costmap:\r\n    ros__parameters:\r\n      update_frequency: 10.0   # Higher frequency for local planning\r\n      publish_frequency: 5.0\r\n      resolution: 0.05         # Higher resolution for local planning\r\n      rolling_window: true\r\n      width: 4                 # Smaller window for performance\r\n      height: 4\r\n      plugins: ["voxel_layer", "inflation_layer"]\r\n\r\n      voxel_layer:\r\n        plugin: "nav2_costmap_2d::VoxelLayer"\r\n        enabled: True\r\n        publish_voxel_map: False  # Disable if not needed\r\n        z_voxels: 8              # Reduce if not needed\r\n        max_obstacle_height: 2.0\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          observation_persistence: 0.0\r\n\r\n      inflation_layer:\r\n        plugin: "nav2_costmap_2d::InflationLayer"\r\n        cost_scaling_factor: 5.0\r\n        inflation_radius: 0.4\n'})}),"\n",(0,s.jsx)(e.h3,{id:"2-memory-management",children:"2. Memory Management"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'# Memory-optimized costmap configuration\r\nglobal_costmap:\r\n  global_costmap:\r\n    ros__parameters:\r\n      # Reduce memory footprint\r\n      width: 50\r\n      height: 50\r\n      resolution: 0.1\r\n      track_unknown_space: False\r\n      always_send_full_costmap: False  # Only send updates\r\n\r\n      # Plugins with memory optimization\r\n      plugins: ["static_layer", "obstacle_layer"]\r\n\r\n      static_layer:\r\n        plugin: "nav2_costmap_2d::StaticLayer"\r\n        map_subscribe_transient_local: True\r\n\r\n      obstacle_layer:\r\n        plugin: "nav2_costmap_2d::ObstacleLayer"\r\n        enabled: True\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n          observation_persistence: 0.1  # Short persistence\r\n          expected_update_rate: 10.0\n'})}),"\n",(0,s.jsx)(e.h2,{id:"costmap-troubleshooting",children:"Costmap Troubleshooting"}),"\n",(0,s.jsx)(e.h3,{id:"1-common-issues-and-solutions",children:"1. Common Issues and Solutions"}),"\n",(0,s.jsx)(e.h4,{id:"issue-costmap-not-updating",children:"Issue: Costmap Not Updating"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Symptoms"}),": Costmap shows static obstacles only, no dynamic obstacle detection\r\n",(0,s.jsx)(e.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["Check sensor topic availability:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ros2 topic echo /scan\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Verify TF tree:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ros2 run tf2_tools view_frames\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Check costmap parameters:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ros2 param list | grep costmap\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h4,{id:"issue-poor-obstacle-detection",children:"Issue: Poor Obstacle Detection"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Symptoms"}),": Robot collides with obstacles or doesn't detect them properly\r\n",(0,s.jsx)(e.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["Adjust sensor range parameters:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"scan:\r\n  raytrace_max_range: 5.0\r\n  obstacle_max_range: 4.0\n"})}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"Verify sensor calibration and mounting"}),"\n",(0,s.jsx)(e.li,{children:"Check for sensor noise or interference"}),"\n"]}),"\n",(0,s.jsx)(e.h4,{id:"issue-high-cpu-usage",children:"Issue: High CPU Usage"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Symptoms"}),": System becomes unresponsive during navigation\r\n",(0,s.jsx)(e.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["Reduce costmap resolution:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"resolution: 0.1  # Increase from 0.05\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Lower update frequencies:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"update_frequency: 2.0  # Reduce from 5.0\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Reduce costmap size:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"width: 4  # Reduce from 6\r\nheight: 4\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h4,{id:"issue-robot-gets-stuck-near-obstacles",children:"Issue: Robot Gets Stuck Near Obstacles"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Symptoms"}),": Robot fails to navigate around obstacles\r\n",(0,s.jsx)(e.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["Increase inflation radius:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"inflation_radius: 0.8  # Increase from 0.55\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Adjust cost scaling factor:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"cost_scaling_factor: 8.0  # Increase from 3.0\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Verify robot radius:","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"robot_radius: 0.3  # Adjust based on actual robot size\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"2-debugging-tools",children:"2. Debugging Tools"}),"\n",(0,s.jsx)(e.h4,{id:"costmap-visualization",children:"Costmap Visualization"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Visualize costmaps in RViz\r\nros2 run rviz2 rviz2 -d /opt/ros/humble/share/nav2_bringup/rviz/nav2_default_view.rviz\r\n\r\n# Add costmap displays:\r\n# - Global Costmap\r\n# - Local Costmap\r\n# - Voxel Grid\r\n# - Particle Cloud\n"})}),"\n",(0,s.jsx)(e.h4,{id:"costmap-analysis",children:"Costmap Analysis"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Monitor costmap updates\r\nros2 topic hz /global_costmap/costmap\r\nros2 topic hz /local_costmap/costmap\r\n\r\n# Check costmap statistics\r\nros2 run nav2_util costmap_analysis\n"})}),"\n",(0,s.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(e.h3,{id:"1-parameter-selection-guidelines",children:"1. Parameter Selection Guidelines"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Resolution"}),": 0.025-0.1m (finer for precise navigation, coarser for performance)"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Update Frequency"}),": 1-10Hz for global, 5-20Hz for local"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Inflation Radius"}),": 1.2-2x robot radius for safety"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Robot Radius"}),": Measure actual robot dimensions + safety margin"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"2-layer-configuration-best-practices",children:"2. Layer Configuration Best Practices"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Use static layer for known obstacles"}),"\n",(0,s.jsx)(e.li,{children:"Use obstacle/voxel layer for sensor data"}),"\n",(0,s.jsx)(e.li,{children:"Always include inflation layer for safety"}),"\n",(0,s.jsx)(e.li,{children:"Consider semantic layers for intelligent navigation"}),"\n",(0,s.jsx)(e.li,{children:"Test layer combinations thoroughly"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"3-performance-optimization",children:"3. Performance Optimization"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Start with conservative parameters"}),"\n",(0,s.jsx)(e.li,{children:"Gradually optimize based on performance"}),"\n",(0,s.jsx)(e.li,{children:"Monitor CPU and memory usage"}),"\n",(0,s.jsx)(e.li,{children:"Balance accuracy with performance requirements"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"integration-with-navigation-system",children:"Integration with Navigation System"}),"\n",(0,s.jsx)(e.h3,{id:"1-controller-integration",children:"1. Controller Integration"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"controller_server:\r\n  ros__parameters:\r\n    # Use costmaps for local planning\r\n    local_costmap_topic: local_costmap/costmap_raw\r\n    global_costmap_topic: global_costmap/costmap_raw\r\n    local_footprint_topic: local_costmap/published_footprint\r\n    global_footprint_topic: global_costmap/published_footprint\n"})}),"\n",(0,s.jsx)(e.h3,{id:"2-planner-integration",children:"2. Planner Integration"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"planner_server:\r\n  ros__parameters:\r\n    # Use global costmap for path planning\r\n    global_costmap_topic: global_costmap/costmap_raw\r\n    global_footprint_topic: global_costmap/published_footprint\n"})}),"\n",(0,s.jsx)(e.h2,{id:"quality-assurance",children:"Quality Assurance"}),"\n",(0,s.jsx)(e.h3,{id:"1-costmap-validation",children:"1. Costmap Validation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Verify obstacle detection accuracy"}),"\n",(0,s.jsx)(e.li,{children:"Check inflation behavior around obstacles"}),"\n",(0,s.jsx)(e.li,{children:"Test navigation in various obstacle configurations"}),"\n",(0,s.jsx)(e.li,{children:"Monitor costmap update rates"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"2-safety-validation",children:"2. Safety Validation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Ensure adequate safety margins"}),"\n",(0,s.jsx)(e.li,{children:"Test edge cases (narrow passages, dynamic obstacles)"}),"\n",(0,s.jsx)(e.li,{children:"Validate behavior with different robot speeds"}),"\n",(0,s.jsx)(e.li,{children:"Check robustness to sensor noise"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"resources",children:"Resources"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://navigation.ros.org/configuration/costmap_configuration/index.html",children:"Navigation2 Costmap Documentation"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://github.com/ros-planning/navigation2/blob/main/nav2_costmap_2d/params/costmap.yaml",children:"Costmap Parameters Guide"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://navigation.ros.org/plugins/costmap_plugins/index.html",children:"Costmap Plugins Documentation"})}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(e.p,{children:"This guide provides comprehensive configuration for costmaps in robot navigation obstacle avoidance. Proper costmap configuration is essential for safe and effective navigation. The key is finding the right balance between safety, performance, and accuracy for your specific application. Start with basic configurations and gradually optimize parameters based on testing results and performance requirements. The integration with Isaac ROS perception can provide even more intelligent and adaptive obstacle avoidance capabilities."})]})}function m(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(p,{...n})}):p(n)}},7074:(n,e,a)=>{a.d(e,{R:()=>i,x:()=>t});var r=a(6540);const s={},o=r.createContext(s);function i(n){const e=r.useContext(o);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),r.createElement(o.Provider,{value:e},n.children)}}}]);