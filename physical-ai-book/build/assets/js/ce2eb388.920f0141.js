"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[7557],{2738:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"ros2-fundamentals/services-actions","title":"ROS 2 Services and Actions - Advanced Communication","description":"Learning Objectives","source":"@site/docs/ros2-fundamentals/services-actions.md","sourceDirName":"ros2-fundamentals","slug":"/ros2-fundamentals/services-actions","permalink":"/./docs/ros2-fundamentals/services-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ros2-fundamentals/services-actions.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Packages - Organization and Management","permalink":"/./docs/ros2-fundamentals/packages"},"next":{"title":"Gazebo Fortress Simulation Environment Installation Guide","permalink":"/./docs/simulation/gazebo-installation"}}');var s=r(4848),c=r(7074);const t={sidebar_position:2},l="ROS 2 Services and Actions - Advanced Communication",a={},o=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Conceptual Overview",id:"conceptual-overview",level:2},{value:"Services",id:"services",level:3},{value:"Actions",id:"actions",level:3},{value:"When to Use Each Pattern",id:"when-to-use-each-pattern",level:3},{value:"Hands-On Implementation",id:"hands-on-implementation",level:2},{value:"Services",id:"services-1",level:3},{value:"Service Definition",id:"service-definition",level:4},{value:"Service Server (Python)",id:"service-server-python",level:4},{value:"Service Client (Python)",id:"service-client-python",level:4},{value:"Actions",id:"actions-1",level:3},{value:"Action Definition",id:"action-definition",level:4},{value:"Action Server (Python)",id:"action-server-python",level:4},{value:"Action Client (Python)",id:"action-client-python",level:4},{value:"Creating the Package",id:"creating-the-package",level:3},{value:"Testing &amp; Verification",id:"testing--verification",level:2},{value:"Testing Services",id:"testing-services",level:3},{value:"Testing Actions",id:"testing-actions",level:3},{value:"Useful Commands for Service and Action Inspection",id:"useful-commands-for-service-and-action-inspection",level:3},{value:"Common Issues",id:"common-issues",level:2},{value:"Issue: Service client cannot connect to server",id:"issue-service-client-cannot-connect-to-server",level:3},{value:"Issue: Action client does not receive feedback",id:"issue-action-client-does-not-receive-feedback",level:3},{value:"Issue: Package build fails with service/action definitions",id:"issue-package-build-fails-with-serviceaction-definitions",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"ros-2-services-and-actions---advanced-communication",children:"ROS 2 Services and Actions - Advanced Communication"})}),"\n",(0,s.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,s.jsx)(n.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Understand the differences between topics, services, and actions in ROS 2"}),"\n",(0,s.jsx)(n.li,{children:"Create and use ROS 2 services for request-response communication"}),"\n",(0,s.jsx)(n.li,{children:"Implement ROS 2 actions for goal-oriented, long-running tasks"}),"\n",(0,s.jsx)(n.li,{children:"Design appropriate communication patterns for different use cases"}),"\n",(0,s.jsx)(n.li,{children:"Test and debug service and action implementations"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Before starting this chapter, you should:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Understand ROS 2 nodes and topics"}),"\n",(0,s.jsx)(n.li,{children:"Have ROS 2 Humble Hawksbill installed and configured"}),"\n",(0,s.jsx)(n.li,{children:"Be familiar with creating ROS 2 packages"}),"\n",(0,s.jsx)(n.li,{children:"Completed the ROS 2 nodes and topics chapter"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"conceptual-overview",children:"Conceptual Overview"}),"\n",(0,s.jsx)(n.p,{children:"In the previous chapter, you learned about topics which use a publish-subscribe communication pattern. While topics are excellent for continuous data streams, many robotics applications require request-response interactions or long-running goal-oriented tasks. This is where services and actions come in."}),"\n",(0,s.jsx)(n.h3,{id:"services",children:"Services"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Services"})," provide a request-response communication pattern where:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A client sends a request to a service"}),"\n",(0,s.jsx)(n.li,{children:"The service processes the request and sends back a response"}),"\n",(0,s.jsx)(n.li,{children:"Communication is synchronous from the client's perspective"}),"\n",(0,s.jsx)(n.li,{children:"Services are ideal for operations that have a clear start and end"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"actions",children:"Actions"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," are designed for long-running tasks that may:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Take a significant amount of time to complete"}),"\n",(0,s.jsx)(n.li,{children:"Provide feedback during execution"}),"\n",(0,s.jsx)(n.li,{children:"Be cancelable or preemptable"}),"\n",(0,s.jsx)(n.li,{children:"Report progress and status during execution"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"when-to-use-each-pattern",children:"When to Use Each Pattern"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Topics"}),": Continuous data streams, sensor data, robot state"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Services"}),": Simple request-response tasks, configuration changes, data retrieval"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Actions"}),": Complex tasks with progress, robot navigation, manipulation sequences"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"hands-on-implementation",children:"Hands-On Implementation"}),"\n",(0,s.jsx)(n.h3,{id:"services-1",children:"Services"}),"\n",(0,s.jsx)(n.h4,{id:"service-definition",children:"Service Definition"}),"\n",(0,s.jsxs)(n.p,{children:["First, let's define a simple service. Create a file called ",(0,s.jsx)(n.code,{children:"AddTwoInts.srv"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"int64 a\r\nint64 b\r\n---\r\nint64 sum\n"})}),"\n",(0,s.jsx)(n.p,{children:"This service takes two integers as input and returns their sum."}),"\n",(0,s.jsx)(n.h4,{id:"service-server-python",children:"Service Server (Python)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Service Server (service_member_function.py):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n# service_member_function.py\r\n\r\n\"\"\"\r\nThis example demonstrates how to create a simple service server using a class member function to handle\r\nincoming requests.\r\n\"\"\"\r\n\r\nimport sys\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\nfrom example_interfaces.srv import AddTwoInts\r\n\r\n\r\nclass MinimalService(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_service')\r\n        # Create a service that will use the callback function to handle requests\r\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\r\n\r\n    def add_two_ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\r\n\r\n        return response\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_service = MinimalService()\r\n\r\n    rclpy.spin(minimal_service)\r\n\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,s.jsx)(n.h4,{id:"service-client-python",children:"Service Client (Python)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Service Client (client_member_function.py):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n# client_member_function.py\r\n\r\n\"\"\"\r\nThis example demonstrates how to create a simple service client using a class member function to send\r\nrequests and handle responses.\r\n\"\"\"\r\n\r\nimport sys\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\nfrom example_interfaces.srv import AddTwoInts\r\n\r\n\r\nclass MinimalClient(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_client')\r\n        # Create a client for the 'add_two_ints' service\r\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\r\n\r\n        # Wait for the service to be available\r\n        while not self.cli.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('Service not available, waiting again...')\r\n\r\n        # Create a request\r\n        self.req = AddTwoInts.Request()\r\n\r\n    def send_request(self, a, b):\r\n        self.req.a = a\r\n        self.req.b = b\r\n        # Call the service asynchronously\r\n        self.future = self.cli.call_async(self.req)\r\n        rclpy.spin_until_future_complete(self, self.future)\r\n        return self.future.result()\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_client = MinimalClient()\r\n    response = minimal_client.send_request(int(sys.argv[1]), int(sys.argv[2]))\r\n\r\n    minimal_client.get_logger().info(\r\n        'Result of add_two_ints: for %d + %d = %d' %\r\n        (int(sys.argv[1]), int(sys.argv[2]), response.sum))\r\n\r\n    minimal_client.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,s.jsx)(n.h3,{id:"actions-1",children:"Actions"}),"\n",(0,s.jsx)(n.h4,{id:"action-definition",children:"Action Definition"}),"\n",(0,s.jsxs)(n.p,{children:["Create an action definition file called ",(0,s.jsx)(n.code,{children:"Fibonacci.action"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"#goal definition\r\nint32 order\r\n\r\n#result definition\r\nint32[] sequence\r\n\r\n#feedback\r\nint32[] sequence\n"})}),"\n",(0,s.jsx)(n.p,{children:"This action generates a Fibonacci sequence of a given order."}),"\n",(0,s.jsx)(n.h4,{id:"action-server-python",children:"Action Server (Python)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Action Server (action_server.py):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\r\n# action_server.py\r\n\r\n"""\r\nThis example demonstrates how to create a simple action server.\r\n"""\r\n\r\nimport time\r\nimport rclpy\r\nfrom rclpy.action import ActionServer, CancelResponse, GoalResponse\r\nfrom rclpy.callback_groups import ReentrantCallbackGroup\r\nfrom rclpy.executors import MultiThreadedExecutor\r\nfrom rclpy.node import Node\r\n\r\nfrom example_interfaces.action import Fibonacci\r\n\r\n\r\nclass FibonacciActionServer(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__(\'fibonacci_action_server\')\r\n        self._action_server = ActionServer(\r\n            self,\r\n            Fibonacci,\r\n            \'fibonacci\',\r\n            execute_callback=self.execute_callback,\r\n            callback_group=ReentrantCallbackGroup(),\r\n            goal_callback=self.goal_callback,\r\n            cancel_callback=self.cancel_callback)\r\n\r\n    def destroy(self):\r\n        self._action_server.destroy()\r\n        super().destroy_node()\r\n\r\n    def goal_callback(self, goal_request):\r\n        """Accept or reject a client request to begin an action."""\r\n        self.get_logger().info(\'Received goal request\')\r\n        return GoalResponse.ACCEPT\r\n\r\n    def cancel_callback(self, goal_handle):\r\n        """Accept or reject a client request to cancel an action."""\r\n        self.get_logger().info(\'Received cancel request\')\r\n        return CancelResponse.ACCEPT\r\n\r\n    async def execute_callback(self, goal_handle):\r\n        """Execute the goal."""\r\n        self.get_logger().info(\'Executing goal...\')\r\n\r\n        # Feedback and result\r\n        feedback_msg = Fibonacci.Feedback()\r\n        feedback_msg.sequence = [0, 1]\r\n        result = Fibonacci.Result()\r\n\r\n        for i in range(1, goal_handle.request.order):\r\n            # Check if the goal has been canceled\r\n            if goal_handle.is_cancel_requested:\r\n                goal_handle.canceled()\r\n                self.get_logger().info(\'Goal canceled\')\r\n                result.sequence = feedback_msg.sequence\r\n                return result\r\n\r\n            # Update the sequence\r\n            feedback_msg.sequence.append(feedback_msg.sequence[i] + feedback_msg.sequence[i-1])\r\n\r\n            # Publish feedback\r\n            goal_handle.publish_feedback(feedback_msg)\r\n            self.get_logger().info(f\'Feedback: {feedback_msg.sequence}\')\r\n\r\n            # Simulate work\r\n            time.sleep(1)\r\n\r\n        # Check if the goal was canceled before completing\r\n        if goal_handle.is_cancel_requested:\r\n            goal_handle.canceled()\r\n            self.get_logger().info(\'Goal canceled\')\r\n            result.sequence = feedback_msg.sequence\r\n            return result\r\n\r\n        # Complete the goal\r\n        goal_handle.succeed()\r\n        result.sequence = feedback_msg.sequence\r\n\r\n        self.get_logger().info(f\'Result: {result.sequence}\')\r\n        return result\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    fibonacci_action_server = FibonacciActionServer()\r\n\r\n    executor = MultiThreadedExecutor()\r\n    rclpy.spin(fibonacci_action_server, executor=executor)\r\n\r\n    fibonacci_action_server.destroy()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),"\n",(0,s.jsx)(n.h4,{id:"action-client-python",children:"Action Client (Python)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Action Client (action_client.py):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n# action_client.py\r\n\r\n\"\"\"\r\nThis example demonstrates how to create a simple action client.\r\n\"\"\"\r\n\r\nimport time\r\nimport rclpy\r\nfrom rclpy.action import ActionClient\r\nfrom rclpy.callback_groups import ReentrantCallbackGroup\r\nfrom rclpy.node import Node\r\n\r\nfrom example_interfaces.action import Fibonacci\r\n\r\n\r\nclass FibonacciActionClient(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('fibonacci_action_client')\r\n        self._action_client = ActionClient(\r\n            self,\r\n            Fibonacci,\r\n            'fibonacci',\r\n            callback_group=ReentrantCallbackGroup())\r\n\r\n    def send_goal(self, order):\r\n        # Wait for the action server to be available\r\n        self.get_logger().info('Waiting for action server...')\r\n        self._action_client.wait_for_server()\r\n\r\n        # Create a goal\r\n        goal_msg = Fibonacci.Goal()\r\n        goal_msg.order = order\r\n\r\n        # Send the goal\r\n        self.get_logger().info(f'Sending goal: {order}')\r\n        send_goal_future = self._action_client.send_goal_async(\r\n            goal_msg,\r\n            feedback_callback=self.feedback_callback)\r\n\r\n        # Wait for the result\r\n        rclpy.spin_until_future_complete(self, send_goal_future)\r\n        goal_handle = send_goal_future.result()\r\n\r\n        if not goal_handle.accepted:\r\n            self.get_logger().info('Goal rejected')\r\n            return\r\n\r\n        self.get_logger().info('Goal accepted')\r\n\r\n        # Get the result\r\n        get_result_future = goal_handle.get_result_async()\r\n        rclpy.spin_until_future_complete(self, get_result_future)\r\n        result = get_result_future.result().result\r\n\r\n        self.get_logger().info(f'Result: {result.sequence}')\r\n        return result\r\n\r\n    def feedback_callback(self, feedback_msg):\r\n        feedback = feedback_msg.feedback\r\n        self.get_logger().info(f'Received feedback: {feedback.sequence}')\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    action_client = FibonacciActionClient()\r\n\r\n    # Send a goal\r\n    action_client.send_goal(10)\r\n\r\n    action_client.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,s.jsx)(n.h3,{id:"creating-the-package",children:"Creating the Package"}),"\n",(0,s.jsx)(n.p,{children:"To create a ROS 2 package for these examples:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Create the package:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\r\nros2 pkg create --build-type ament_python py_srvcli\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Create the service definition directory:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir -p py_srvcli/py_srvcli\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Add the Python files to the package:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Copy service server to py_srvcli/py_srvcli/service_member_function.py\r\n# Copy service client to py_srvcli/py_srvcli/client_member_function.py\r\n# Copy action server to py_srvcli/py_srvcli/action_server.py\r\n# Copy action client to py_srvcli/py_srvcli/action_client.py\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Make the Python files executable:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"chmod +x py_srvcli/py_srvcli/service_member_function.py\r\nchmod +x py_srvcli/py_srvcli/client_member_function.py\r\nchmod +x py_srvcli/py_srvcli/action_server.py\r\nchmod +x py_srvcli/py_srvcli/action_client.py\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"5",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Update setup.py to include entry points:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"entry_points={\r\n    'console_scripts': [\r\n        'add_two_ints_server = py_srvcli.service_member_function:main',\r\n        'add_two_ints_client = py_srvcli.client_member_function:main',\r\n        'fibonacci_server = py_srvcli.action_server:main',\r\n        'fibonacci_client = py_srvcli.action_client:main',\r\n    ],\r\n},\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"6",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Build the package:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\ncolcon build --packages-select py_srvcli\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"7",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Source the workspace:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n",(0,s.jsx)(n.h2,{id:"testing--verification",children:"Testing & Verification"}),"\n",(0,s.jsx)(n.h3,{id:"testing-services",children:"Testing Services"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Open two terminal windows"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"In the first terminal, source your workspace and run the service server:"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\nsource install/setup.bash\r\nros2 run py_srvcli add_two_ints_server\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"In the second terminal, source your workspace and run the service client:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\nsource install/setup.bash\r\nros2 run py_srvcli add_two_ints_client 2 3\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"You should see the server receive the request and the client get the response:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"[INFO] [1601234567.123456789] [minimal_service]: Incoming request\r\na: 2 b: 3\r\n[INFO] [1601234567.123456789] [minimal_client]: Result of add_two_ints: for 2 + 3 = 5\n"})}),"\n",(0,s.jsx)(n.h3,{id:"testing-actions",children:"Testing Actions"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Open two terminal windows"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"In the first terminal, source your workspace and run the action server:"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\nsource install/setup.bash\r\nros2 run py_srvcli fibonacci_server\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"In the second terminal, source your workspace and run the action client:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\nsource install/setup.bash\r\nros2 run py_srvcli fibonacci_client\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"You should see feedback during execution and the final result:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"[INFO] [1601234567.123456789] [fibonacci_action_client]: Waiting for action server...\r\n[INFO] [1601234567.123456789] [fibonacci_action_client]: Sending goal: 10\r\n[INFO] [1601234567.123456789] [fibonacci_action_client]: Received feedback: [0, 1, 1]\r\n[INFO] [1601234567.123456789] [fibonacci_action_client]: Received feedback: [0, 1, 1, 2]\r\n...\r\n[INFO] [1601234567.123456789] [fibonacci_action_client]: Result: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"useful-commands-for-service-and-action-inspection",children:"Useful Commands for Service and Action Inspection"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"List all services:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 service list\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Get info about a specific service:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 service info /add_two_ints\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Call a service directly:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 service call /add_two_ints example_interfaces/srv/AddTwoInts '{a: 1, b: 2}'\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"List all actions:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 action list\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Get info about a specific action:"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 action info /fibonacci\n"})}),"\n",(0,s.jsx)(n.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,s.jsx)(n.h3,{id:"issue-service-client-cannot-connect-to-server",children:"Issue: Service client cannot connect to server"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Verify the service server is running"}),"\n",(0,s.jsx)(n.li,{children:"Check that service names match exactly"}),"\n",(0,s.jsx)(n.li,{children:"Ensure both nodes are in the same ROS domain"}),"\n",(0,s.jsx)(n.li,{children:"Check network connectivity if nodes are on different machines"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"issue-action-client-does-not-receive-feedback",children:"Issue: Action client does not receive feedback"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Verify the action server is publishing feedback"}),"\n",(0,s.jsx)(n.li,{children:"Check that the action definition matches between client and server"}),"\n",(0,s.jsx)(n.li,{children:"Ensure the action server is not completing too quickly"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"issue-package-build-fails-with-serviceaction-definitions",children:"Issue: Package build fails with service/action definitions"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Make sure to add the correct dependencies in package.xml"}),"\n",(0,s.jsxs)(n.li,{children:["For services: add ",(0,s.jsx)(n.code,{children:"<depend>example_interfaces</depend>"})]}),"\n",(0,s.jsxs)(n.li,{children:["For actions: add ",(0,s.jsx)(n.code,{children:"<depend>example_interfaces</depend>"})]}),"\n",(0,s.jsx)(n.li,{children:"Ensure the correct message types are imported"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Services provide request-response communication, ideal for quick operations"}),"\n",(0,s.jsx)(n.li,{children:"Actions are designed for long-running tasks with feedback and cancellation"}),"\n",(0,s.jsx)(n.li,{children:"Services are synchronous from the client perspective"}),"\n",(0,s.jsx)(n.li,{children:"Actions provide asynchronous communication with progress tracking"}),"\n",(0,s.jsx)(n.li,{children:"Use topics for continuous data streams, services for simple requests, and actions for complex tasks"}),"\n",(0,s.jsx)(n.li,{children:"Both services and actions have built-in tools for inspection and debugging"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(n.p,{children:"In the next chapter, you'll learn about ROS 2 packages and how to organize your code effectively in the ROS 2 ecosystem."})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},7074:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>l});var i=r(6540);const s={},c=i.createContext(s);function t(e){const n=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);