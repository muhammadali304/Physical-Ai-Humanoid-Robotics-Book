"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[6106],{7074:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},9753:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"ros2-fundamentals/nodes-topics","title":"ROS 2 Nodes and Topics - Fundamentals","description":"Learning Objectives","source":"@site/docs/ros2-fundamentals/nodes-topics.md","sourceDirName":"ros2-fundamentals","slug":"/ros2-fundamentals/nodes-topics","permalink":"/docs/ros2-fundamentals/nodes-topics","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ros2-fundamentals/nodes-topics.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Validation Testing for ROS 2 Setup Instructions","permalink":"/docs/setup/validation-testing"},"next":{"title":"ROS 2 Packages - Organization and Management","permalink":"/docs/ros2-fundamentals/packages"}}');var r=s(4848),t=s(7074);const l={sidebar_position:1},c="ROS 2 Nodes and Topics - Fundamentals",o={},a=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Conceptual Overview",id:"conceptual-overview",level:2},{value:"Nodes",id:"nodes",level:3},{value:"Topics",id:"topics",level:3},{value:"Communication Pattern",id:"communication-pattern",level:3},{value:"Hands-On Implementation",id:"hands-on-implementation",level:2},{value:"Python Implementation",id:"python-implementation",level:3},{value:"C++ Implementation",id:"c-implementation",level:3},{value:"Setting up the Package",id:"setting-up-the-package",level:3},{value:"Testing &amp; Verification",id:"testing--verification",level:2},{value:"Running the Nodes",id:"running-the-nodes",level:3},{value:"Useful Commands for Topic Inspection",id:"useful-commands-for-topic-inspection",level:3},{value:"Common Issues",id:"common-issues",level:2},{value:"Issue: &quot;Topic not found&quot; or no communication between nodes",id:"issue-topic-not-found-or-no-communication-between-nodes",level:3},{value:"Issue: Python import errors",id:"issue-python-import-errors",level:3},{value:"Issue: Nodes cannot communicate between different machines",id:"issue-nodes-cannot-communicate-between-different-machines",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"ros-2-nodes-and-topics---fundamentals",children:"ROS 2 Nodes and Topics - Fundamentals"})}),"\n",(0,r.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(n.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Explain the concepts of nodes and topics in ROS 2"}),"\n",(0,r.jsx)(n.li,{children:"Create a simple ROS 2 node in Python and C++"}),"\n",(0,r.jsx)(n.li,{children:"Implement publisher and subscriber nodes"}),"\n",(0,r.jsx)(n.li,{children:"Understand the communication patterns between nodes"}),"\n",(0,r.jsx)(n.li,{children:"Test and verify node communication"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"Before starting this chapter, you should:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Have ROS 2 Humble Hawksbill installed and configured"}),"\n",(0,r.jsx)(n.li,{children:"Understand basic Linux command line operations"}),"\n",(0,r.jsx)(n.li,{children:"Have Python and C++ programming knowledge"}),"\n",(0,r.jsx)(n.li,{children:"Completed the ROS 2 setup chapter"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"conceptual-overview",children:"Conceptual Overview"}),"\n",(0,r.jsx)(n.p,{children:"ROS 2 (Robot Operating System 2) is a flexible framework for writing robot software. At its core, ROS 2 provides a communication infrastructure that allows different parts of your robot software to work together seamlessly."}),"\n",(0,r.jsx)(n.h3,{id:"nodes",children:"Nodes"}),"\n",(0,r.jsxs)(n.p,{children:["A ",(0,r.jsx)(n.strong,{children:"node"})," is a process that performs computation. Nodes are the fundamental building blocks of ROS 2 programs. In a typical robot system, nodes might handle different tasks such as sensor processing, motion planning, or control."]}),"\n",(0,r.jsx)(n.h3,{id:"topics",children:"Topics"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Topics"})," enable message passing between nodes. Nodes can publish messages to topics or subscribe to topics to receive messages. This creates a publish-subscribe communication pattern where publishers and subscribers are decoupled."]}),"\n",(0,r.jsx)(n.h3,{id:"communication-pattern",children:"Communication Pattern"}),"\n",(0,r.jsx)(n.p,{children:"The publisher-subscriber pattern works as follows:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Publisher nodes send messages to a specific topic"}),"\n",(0,r.jsx)(n.li,{children:"Subscriber nodes receive messages from that topic"}),"\n",(0,r.jsx)(n.li,{children:"The ROS 2 middleware handles the delivery of messages"}),"\n",(0,r.jsx)(n.li,{children:"Multiple publishers can send to the same topic"}),"\n",(0,r.jsx)(n.li,{children:"Multiple subscribers can receive from the same topic"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"hands-on-implementation",children:"Hands-On Implementation"}),"\n",(0,r.jsx)(n.h3,{id:"python-implementation",children:"Python Implementation"}),"\n",(0,r.jsx)(n.p,{children:"Let's create a simple publisher node that publishes messages with a counter:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Publisher Node (publisher_member_function.py):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n# publisher_member_function.py\n\n\"\"\"\nThis example demonstrates how to create a simple publisher using a class member function to handle\npublishing data being sent to a topic.\n\"\"\"\n\nimport rclpy\nfrom rclpy.node import Node\n\nfrom std_msgs.msg import String\n\n\nclass MinimalPublisher(Node):\n\n    def __init__(self):\n        # Calls the superclass constructor\n        super().__init__('minimal_publisher')\n\n        # Create a publisher that will publish String messages to the 'topic' topic\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n\n        # Create a timer that will call the timer_callback method every 0.5 seconds\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n        # Initialize a counter\n        self.i = 0\n\n    def timer_callback(self):\n        # Create a String message\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n\n        # Publish the message\n        self.publisher_.publish(msg)\n\n        # Log the message being published\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n\n        # Increment the counter\n        self.i += 1\n\n\ndef main(args=None):\n    # Initialize the rclpy library\n    rclpy.init(args=args)\n\n    # Create an instance of the MinimalPublisher class\n    minimal_publisher = MinimalPublisher()\n\n    # Spin the node so the callback function is called\n    rclpy.spin(minimal_publisher)\n\n    # Destroy the node explicitly (optional - otherwise it will be done automatically\n    # when the garbage collector destroys the node object)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Subscriber Node (subscriber_member_function.py):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n# subscriber_member_function.py\n\n\"\"\"\nThis example demonstrates how to create a simple subscriber using a class member function to handle\nreceiving data from a topic.\n\"\"\"\n\nimport rclpy\nfrom rclpy.node import Node\n\nfrom std_msgs.msg import String\n\n\nclass MinimalSubscriber(Node):\n\n    def __init__(self):\n        # Calls the superclass constructor\n        super().__init__('minimal_subscriber')\n\n        # Create a subscription that will receive String messages from the 'topic' topic\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        # Log the received message\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\n\ndef main(args=None):\n    # Initialize the rclpy library\n    rclpy.init(args=args)\n\n    # Create an instance of the MinimalSubscriber class\n    minimal_subscriber = MinimalSubscriber()\n\n    # Spin the node so the callback function is called\n    rclpy.spin(minimal_subscriber)\n\n    # Destroy the node explicitly (optional - otherwise it will be done automatically\n    # when the garbage collector destroys the node object)\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"c-implementation",children:"C++ Implementation"}),"\n",(0,r.jsx)(n.p,{children:"For completeness, here are the C++ versions of the same nodes:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Publisher Node (minimal_publisher.cpp):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include <chrono>\n#include <functional>\n#include <memory>\n#include <string>\n\n#include "rclcpp/rclcpp.hpp"\n#include "std_msgs/msg/string.hpp"\n\nusing namespace std::chrono_literals;\n\nclass MinimalPublisher : public rclcpp::Node\n{\npublic:\n  MinimalPublisher()\n  : Node("minimal_publisher"), count_(0)\n  {\n    publisher_ = this->create_publisher<std_msgs::msg::String>("topic", 10);\n    timer_ = this->create_wall_timer(\n      500ms, std::bind(&MinimalPublisher::timer_callback, this));\n  }\n\nprivate:\n  void timer_callback()\n  {\n    auto message = std_msgs::msg::String();\n    message.data = "Hello, world! " + std::to_string(count_++);\n    RCLCPP_INFO(this->get_logger(), "Publishing: \'%s\'", message.data.c_str());\n    publisher_->publish(message);\n  }\n  rclcpp::TimerBase::SharedPtr timer_;\n  rclcpp::Publisher<std_msgs::msg::String>::SharedPtr publisher_;\n  size_t count_;\n};\n\nint main(int argc, char * argv[])\n{\n  rclcpp::init(argc, argv);\n  rclcpp::spin(std::make_shared<MinimalPublisher>());\n  rclcpp::shutdown();\n  return 0;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Subscriber Node (minimal_subscriber.cpp):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include <memory>\n\n#include "rclcpp/rclcpp.hpp"\n#include "std_msgs/msg/string.hpp"\n\nusing std::placeholders::_1;\n\nclass MinimalSubscriber : public rclcpp::Node\n{\npublic:\n  MinimalSubscriber()\n  : Node("minimal_subscriber")\n  {\n    subscription_ = this->create_subscription<std_msgs::msg::String>(\n      "topic", 10, std::bind(&MinimalSubscriber::topic_callback, this, _1));\n  }\n\nprivate:\n  void topic_callback(const std_msgs::msg::String::SharedPtr msg) const\n  {\n    RCLCPP_INFO(this->get_logger(), "I heard: \'%s\'", msg->data.c_str());\n  }\n  rclcpp::Subscription<std_msgs::msg::String>::SharedPtr subscription_;\n};\n\nint main(int argc, char * argv[])\n{\n  rclcpp::init(argc, argv);\n  rclcpp::spin(std::make_shared<MinimalSubscriber>());\n  rclcpp::shutdown();\n  return 0;\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"setting-up-the-package",children:"Setting up the Package"}),"\n",(0,r.jsx)(n.p,{children:"To create a ROS 2 package for these examples:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Create the package:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\nros2 pkg create --build-type ament_python py_pubsub\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Add the Python files to the package:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Copy the publisher to py_pubsub/py_pubsub/publisher_member_function.py\n# Copy the subscriber to py_pubsub/py_pubsub/subscriber_member_function.py\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Make the Python files executable:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x py_pubsub/py_pubsub/publisher_member_function.py\nchmod +x py_pubsub/py_pubsub/subscriber_member_function.py\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Update setup.py to include entry points:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"entry_points={\n    'console_scripts': [\n        'talker = py_pubsub.publisher_member_function:main',\n        'listener = py_pubsub.subscriber_member_function:main',\n    ],\n},\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Build the package:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select py_pubsub\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Source the workspace:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n",(0,r.jsx)(n.h2,{id:"testing--verification",children:"Testing & Verification"}),"\n",(0,r.jsx)(n.h3,{id:"running-the-nodes",children:"Running the Nodes"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open two terminal windows"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"In the first terminal, source your workspace and run the publisher:"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\nsource install/setup.bash\nros2 run py_pubsub talker\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"In the second terminal, source your workspace and run the subscriber:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\nsource install/setup.bash\nros2 run py_pubsub listener\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"You should see the publisher sending messages and the subscriber receiving them:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[INFO] [1601234567.123456789] [minimal_publisher]: Publishing: "Hello World: 0"\n[INFO] [1601234567.623456789] [minimal_publisher]: Publishing: "Hello World: 1"\n[INFO] [1601234567.123456789] [minimal_subscriber]: I heard: "Hello World: 0"\n[INFO] [1601234567.623456789] [minimal_subscriber]: I heard: "Hello World: 1"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"useful-commands-for-topic-inspection",children:"Useful Commands for Topic Inspection"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"List all topics:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic list\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Get info about a specific topic:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic info /topic\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Echo messages on a topic:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic echo /topic std_msgs/msg/String\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Publish directly to a topic:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic pub /topic std_msgs/msg/String 'data: \"Hello from command line\"'\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Check topic statistics:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic hz /topic\n"})}),"\n",(0,r.jsx)(n.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsx)(n.h3,{id:"issue-topic-not-found-or-no-communication-between-nodes",children:'Issue: "Topic not found" or no communication between nodes'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verify both nodes are running"}),"\n",(0,r.jsx)(n.li,{children:"Check that topic names match exactly"}),"\n",(0,r.jsx)(n.li,{children:"Ensure both nodes are in the same ROS domain (ROS_DOMAIN_ID environment variable)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"issue-python-import-errors",children:"Issue: Python import errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Make sure the package was built with ",(0,r.jsx)(n.code,{children:"colcon build"})]}),"\n",(0,r.jsxs)(n.li,{children:["Source the workspace with ",(0,r.jsx)(n.code,{children:"source install/setup.bash"})]}),"\n",(0,r.jsx)(n.li,{children:"Check that the Python files have the correct permissions"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"issue-nodes-cannot-communicate-between-different-machines",children:"Issue: Nodes cannot communicate between different machines"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check network connectivity"}),"\n",(0,r.jsx)(n.li,{children:"Verify ROS_LOCALHOST_ONLY is not set to 1"}),"\n",(0,r.jsx)(n.li,{children:"Ensure RMW_IMPLEMENTATION is consistent across machines"}),"\n",(0,r.jsx)(n.li,{children:"Check firewall settings for DDS communication ports"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Nodes are the basic execution units in ROS 2 that perform computation"}),"\n",(0,r.jsx)(n.li,{children:"Topics enable decoupled communication between nodes using publisher-subscriber pattern"}),"\n",(0,r.jsx)(n.li,{children:"Messages are the data packets sent between nodes via topics"}),"\n",(0,r.jsx)(n.li,{children:"Multiple publishers and subscribers can use the same topic"}),"\n",(0,r.jsx)(n.li,{children:"ROS 2 provides built-in tools for debugging and inspecting topic communication"}),"\n",(0,r.jsx)(n.li,{children:"Both Python and C++ implementations follow the same patterns with language-specific syntax"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsx)(n.p,{children:"In the next chapter, you'll learn about ROS 2 services and actions, which provide request-response communication patterns that complement the publish-subscribe model you've learned here."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);