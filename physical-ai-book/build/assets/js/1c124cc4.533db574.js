"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[372],{5733:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"simulation/gazebo-basics","title":"Gazebo Simulation - Basics","description":"Learning Objectives","source":"@site/docs/simulation/gazebo-basics.md","sourceDirName":"simulation","slug":"/simulation/gazebo-basics","permalink":"/./docs/simulation/gazebo-basics","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/simulation/gazebo-basics.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Gazebo Fortress Simulation Environment Installation Guide","permalink":"/./docs/simulation/gazebo-installation"},"next":{"title":"URDF Modeling - Robot Description Format","permalink":"/./docs/simulation/urdf-modeling"}}');var s=r(4848),o=r(7074);const l={sidebar_position:1},a="Gazebo Simulation - Basics",t={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Conceptual Overview",id:"conceptual-overview",level:2},{value:"Key Components of Gazebo",id:"key-components-of-gazebo",level:3},{value:"Integration with ROS 2",id:"integration-with-ros-2",level:3},{value:"Benefits of Simulation",id:"benefits-of-simulation",level:3},{value:"Hands-On Implementation",id:"hands-on-implementation",level:2},{value:"Installing Gazebo",id:"installing-gazebo",level:3},{value:"Installing Gazebo ROS Packages",id:"installing-gazebo-ros-packages",level:3},{value:"Basic Gazebo Commands",id:"basic-gazebo-commands",level:3},{value:"Creating a Simple World",id:"creating-a-simple-world",level:3},{value:"Running Gazebo with Your World",id:"running-gazebo-with-your-world",level:3},{value:"Creating a Simple Robot Model (URDF)",id:"creating-a-simple-robot-model-urdf",level:3},{value:"Converting URDF to SDF for Gazebo",id:"converting-urdf-to-sdf-for-gazebo",level:3},{value:"Creating a Gazebo Plugin for ROS 2 Integration",id:"creating-a-gazebo-plugin-for-ros-2-integration",level:3},{value:"Creating a ROS 2 Node for Robot Control",id:"creating-a-ros-2-node-for-robot-control",level:3},{value:"Creating a URDF Directory and Adding Your Robot",id:"creating-a-urdf-directory-and-adding-your-robot",level:3},{value:"Updating package.xml",id:"updating-packagexml",level:3},{value:"Testing &amp; Verification",id:"testing--verification",level:2},{value:"Running the Simulation",id:"running-the-simulation",level:3},{value:"Useful Gazebo Commands",id:"useful-gazebo-commands",level:3},{value:"ROS 2 Integration Commands",id:"ros-2-integration-commands",level:3},{value:"Common Issues",id:"common-issues",level:2},{value:"Issue: Gazebo doesn&#39;t start or crashes",id:"issue-gazebo-doesnt-start-or-crashes",level:3},{value:"Issue: Robot doesn&#39;t appear in Gazebo",id:"issue-robot-doesnt-appear-in-gazebo",level:3},{value:"Issue: No sensor data from Gazebo",id:"issue-no-sensor-data-from-gazebo",level:3},{value:"Issue: Robot control not working",id:"issue-robot-control-not-working",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"gazebo-simulation---basics",children:"Gazebo Simulation - Basics"})}),"\n",(0,s.jsx)(e.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,s.jsx)(e.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Understand the Gazebo simulation environment and its components"}),"\n",(0,s.jsx)(e.li,{children:"Install and configure Gazebo for ROS 2 integration"}),"\n",(0,s.jsx)(e.li,{children:"Create basic simulation worlds with objects and environments"}),"\n",(0,s.jsx)(e.li,{children:"Spawn and control robots in simulation"}),"\n",(0,s.jsx)(e.li,{children:"Integrate Gazebo with ROS 2 nodes for sensor simulation"}),"\n",(0,s.jsx)(e.li,{children:"Test robotics algorithms in a safe virtual environment"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(e.p,{children:"Before starting this chapter, you should:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Have ROS 2 Humble Hawksbill installed and configured"}),"\n",(0,s.jsx)(e.li,{children:"Understand ROS 2 nodes, topics, and packages"}),"\n",(0,s.jsx)(e.li,{children:"Have basic knowledge of Linux command line operations"}),"\n",(0,s.jsx)(e.li,{children:"Completed the ROS 2 fundamentals chapters"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"conceptual-overview",children:"Conceptual Overview"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Gazebo"})," is a 3D simulation environment that provides realistic physics simulation, high-quality graphics, and convenient programmatic interfaces. It's widely used in robotics research and development for testing algorithms before deploying to real hardware."]}),"\n",(0,s.jsx)(e.h3,{id:"key-components-of-gazebo",children:"Key Components of Gazebo"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Physics Engine"}),": Provides realistic simulation of rigid body dynamics"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Rendering Engine"}),": Creates visual representations of the environment"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Sensor Simulation"}),": Emulates real-world sensors like cameras, LIDAR, IMU"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Plugins"}),": Extend functionality through custom code"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"World Editor"}),": Create and modify simulation environments"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"integration-with-ros-2",children:"Integration with ROS 2"}),"\n",(0,s.jsx)(e.p,{children:"Gazebo integrates seamlessly with ROS 2 through:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Gazebo ROS packages"}),": Bridge between Gazebo and ROS 2"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Sensor plugins"}),": Publish sensor data to ROS 2 topics"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Actuator plugins"}),": Subscribe to ROS 2 topics to control simulated robots"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Launch files"}),": Start Gazebo and ROS 2 nodes together"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"benefits-of-simulation",children:"Benefits of Simulation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Safety"}),": Test algorithms without risk to hardware"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Cost-effective"}),": No physical hardware required"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Repeatability"}),": Consistent testing conditions"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Speed"}),": Faster than real-time execution possible"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Flexibility"}),": Easy to modify environments and scenarios"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"hands-on-implementation",children:"Hands-On Implementation"}),"\n",(0,s.jsx)(e.h3,{id:"installing-gazebo",children:"Installing Gazebo"}),"\n",(0,s.jsx)(e.p,{children:"For ROS 2 Humble, we'll use Gazebo Garden (formerly Ignition):"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'# Add the Gazebo repository\r\nsudo apt update && sudo apt install wget\r\nsudo wget https://packages.osrfoundation.org/gazebo.gpg -O /usr/share/keyrings/pkgs-gazebo-archive-keyring.gpg\r\necho "deb [arch=amd64 signed-by=/usr/share/keyrings/pkgs-gazebo-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/gazebo-stable.list > /dev/null\r\n\r\n# Update package lists\r\nsudo apt update\r\n\r\n# Install Gazebo Garden\r\nsudo apt install gazebo-garden\n'})}),"\n",(0,s.jsx)(e.h3,{id:"installing-gazebo-ros-packages",children:"Installing Gazebo ROS Packages"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Install ROS 2 Gazebo packages\r\nsudo apt install ros-humble-gazebo-ros ros-humble-gazebo-plugins ros-humble-gazebo-dev\r\nsudo apt install ros-humble-gazebo-ros-pkgs ros-humble-gazebo-ros-control\n"})}),"\n",(0,s.jsx)(e.h3,{id:"basic-gazebo-commands",children:"Basic Gazebo Commands"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Start Gazebo GUI:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"gz sim\n"})}),"\n",(0,s.jsxs)(e.ol,{start:"2",children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Start Gazebo with a world:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"gz sim -r empty.sdf\n"})}),"\n",(0,s.jsxs)(e.ol,{start:"3",children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"List running Gazebo instances:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"gz service -s /gazebo/worlds\n"})}),"\n",(0,s.jsx)(e.h3,{id:"creating-a-simple-world",children:"Creating a Simple World"}),"\n",(0,s.jsx)(e.p,{children:"Let's create a basic world file with some objects:"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Create a world file (my_world.sdf):"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\r\n<sdf version="1.7">\r\n  <world name="my_world">\r\n    \x3c!-- Include a default lighting configuration --\x3e\r\n    <include>\r\n      <uri>model://sun</uri>\r\n    </include>\r\n\r\n    \x3c!-- Include a ground plane --\x3e\r\n    <include>\r\n      <uri>model://ground_plane</uri>\r\n    </include>\r\n\r\n    \x3c!-- Add a simple box object --\x3e\r\n    <model name="box">\r\n      <pose>2 2 0.5 0 0 0</pose>\r\n      <link name="link">\r\n        <collision name="collision">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n        </collision>\r\n        <visual name="visual">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n          <material>\r\n            <ambient>1 0 0 1</ambient>\r\n            <diffuse>1 0 0 1</diffuse>\r\n            <specular>1 0 0 1</specular>\r\n          </material>\r\n        </visual>\r\n      </link>\r\n    </model>\r\n\r\n    \x3c!-- Add a cylinder object --\x3e\r\n    <model name="cylinder">\r\n      <pose>-2 2 1 0 0 0</pose>\r\n      <link name="link">\r\n        <collision name="collision">\r\n          <geometry>\r\n            <cylinder>\r\n              <radius>0.5</radius>\r\n              <length>2</length>\r\n            </cylinder>\r\n          </geometry>\r\n        </collision>\r\n        <visual name="visual">\r\n          <geometry>\r\n            <cylinder>\r\n              <radius>0.5</radius>\r\n              <length>2</length>\r\n            </cylinder>\r\n          </geometry>\r\n          <material>\r\n            <ambient>0 1 0 1</ambient>\r\n            <diffuse>0 1 0 1</diffuse>\r\n            <specular>0 1 0 1</specular>\r\n          </material>\r\n        </visual>\r\n      </link>\r\n    </model>\r\n\r\n    \x3c!-- Add a sphere object --\x3e\r\n    <model name="sphere">\r\n      <pose>0 -2 1 0 0 0</pose>\r\n      <link name="link">\r\n        <collision name="collision">\r\n          <geometry>\r\n            <sphere>\r\n              <radius>0.5</radius>\r\n            </sphere>\r\n          </geometry>\r\n        </collision>\r\n        <visual name="visual">\r\n          <geometry>\r\n            <sphere>\r\n              <radius>0.5</radius>\r\n            </sphere>\r\n          </geometry>\r\n          <material>\r\n            <ambient>0 0 1 1</ambient>\r\n            <diffuse>0 0 1 1</diffuse>\r\n            <specular>0 0 1 1</specular>\r\n          </material>\r\n        </visual>\r\n      </link>\r\n    </model>\r\n  </world>\r\n</sdf>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"running-gazebo-with-your-world",children:"Running Gazebo with Your World"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Save the world file"})," as ",(0,s.jsx)(e.code,{children:"my_world.sdf"})," in your home directory"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Start Gazebo with your world:"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"gz sim -r ~/my_world.sdf\n"})}),"\n",(0,s.jsx)(e.h3,{id:"creating-a-simple-robot-model-urdf",children:"Creating a Simple Robot Model (URDF)"}),"\n",(0,s.jsx)(e.p,{children:"Let's create a simple differential drive robot:"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Create a URDF file (simple_robot.urdf):"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<robot name="simple_robot" xmlns:xacro="http://www.ros.org/wiki/xacro">\r\n  \x3c!-- Base link --\x3e\r\n  <link name="base_link">\r\n    <visual>\r\n      <geometry>\r\n        <box size="0.5 0.3 0.15"/>\r\n      </geometry>\r\n      <material name="blue">\r\n        <color rgba="0 0 1 1"/>\r\n      </material>\r\n    </visual>\r\n    <collision>\r\n      <geometry>\r\n        <box size="0.5 0.3 0.15"/>\r\n      </geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="1.0"/>\r\n      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>\r\n    </inertial>\r\n  </link>\r\n\r\n  \x3c!-- Left wheel --\x3e\r\n  <joint name="left_wheel_joint" type="continuous">\r\n    <parent link="base_link"/>\r\n    <child link="left_wheel"/>\r\n    <origin xyz="0 0.2 -0.05" rpy="1.5707 0 0"/>\r\n    <axis xyz="0 0 1"/>\r\n  </joint>\r\n\r\n  <link name="left_wheel">\r\n    <visual>\r\n      <geometry>\r\n        <cylinder radius="0.05" length="0.05"/>\r\n      </geometry>\r\n      <material name="black">\r\n        <color rgba="0 0 0 1"/>\r\n      </material>\r\n    </visual>\r\n    <collision>\r\n      <geometry>\r\n        <cylinder radius="0.05" length="0.05"/>\r\n      </geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="0.1"/>\r\n      <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>\r\n    </inertial>\r\n  </link>\r\n\r\n  \x3c!-- Right wheel --\x3e\r\n  <joint name="right_wheel_joint" type="continuous">\r\n    <parent link="base_link"/>\r\n    <child link="right_wheel"/>\r\n    <origin xyz="0 -0.2 -0.05" rpy="1.5707 0 0"/>\r\n    <axis xyz="0 0 1"/>\r\n  </joint>\r\n\r\n  <link name="right_wheel">\r\n    <visual>\r\n      <geometry>\r\n        <cylinder radius="0.05" length="0.05"/>\r\n      </geometry>\r\n      <material name="black">\r\n        <color rgba="0 0 0 1"/>\r\n      </material>\r\n    </visual>\r\n    <collision>\r\n      <geometry>\r\n        <cylinder radius="0.05" length="0.05"/>\r\n      </geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="0.1"/>\r\n      <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>\r\n    </inertial>\r\n  </link>\r\n\r\n  \x3c!-- Add a simple camera sensor --\x3e\r\n  <joint name="camera_joint" type="fixed">\r\n    <parent link="base_link"/>\r\n    <child link="camera_link"/>\r\n    <origin xyz="0.2 0 0.05" rpy="0 0 0"/>\r\n  </joint>\r\n\r\n  <link name="camera_link">\r\n    <visual>\r\n      <geometry>\r\n        <box size="0.05 0.05 0.05"/>\r\n      </geometry>\r\n      <material name="red">\r\n        <color rgba="1 0 0 1"/>\r\n      </material>\r\n    </visual>\r\n    <collision>\r\n      <geometry>\r\n        <box size="0.05 0.05 0.05"/>\r\n      </geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="0.01"/>\r\n      <inertia ixx="0.0001" ixy="0.0" ixz="0.0" iyy="0.0001" iyz="0.0" izz="0.0001"/>\r\n    </inertial>\r\n  </link>\r\n</robot>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"converting-urdf-to-sdf-for-gazebo",children:"Converting URDF to SDF for Gazebo"}),"\n",(0,s.jsx)(e.p,{children:"To use URDF in Gazebo, we often need to convert it to SDF format or use ROS 2 integration:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Install urdf2gazebo if available, or use xacro to preprocess\r\nsudo apt install ros-humble-xacro\n"})}),"\n",(0,s.jsx)(e.h3,{id:"creating-a-gazebo-plugin-for-ros-2-integration",children:"Creating a Gazebo Plugin for ROS 2 Integration"}),"\n",(0,s.jsx)(e.p,{children:"Let's create a simple launch file that starts Gazebo with our robot:"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Create a launch directory in your package:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src/robot_controller/launch\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Create a launch file (robot_controller/launch/gazebo_simulation.launch.py):"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"from launch import LaunchDescription\r\nfrom launch.actions import IncludeLaunchDescription, ExecuteProcess\r\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\r\nfrom launch.substitutions import PathJoinSubstitution\r\nfrom launch_ros.actions import Node\r\nfrom launch_ros.substitutions import FindPackageShare\r\n\r\n\r\ndef generate_launch_description():\r\n    # Start Gazebo with a world\r\n    gazebo = IncludeLaunchDescription(\r\n        PythonLaunchDescriptionSource([\r\n            PathJoinSubstitution([\r\n                FindPackageShare('ros_gz_sim'),\r\n                'launch',\r\n                'gz_sim.launch.py'\r\n            ])\r\n        ]),\r\n        launch_arguments={\r\n            'gz_args': '-r empty.sdf'  # Use empty world initially\r\n        }.items()\r\n    )\r\n\r\n    # Spawn robot in Gazebo\r\n    spawn_entity = Node(\r\n        package='ros_gz_sim',\r\n        executable='create',\r\n        arguments=[\r\n            '-name', 'simple_robot',\r\n            '-topic', 'robot_description',\r\n            '-x', '0',\r\n            '-y', '0',\r\n            '-z', '0.1'\r\n        ],\r\n        output='screen'\r\n    )\r\n\r\n    # Robot state publisher\r\n    robot_state_publisher = Node(\r\n        package='robot_state_publisher',\r\n        executable='robot_state_publisher',\r\n        name='robot_state_publisher',\r\n        output='screen',\r\n        parameters=[{'use_sim_time': True}],\r\n        arguments=[PathJoinSubstitution([\r\n            FindPackageShare('robot_controller'),\r\n            'urdf',\r\n            'simple_robot.urdf'\r\n        ])]\r\n    )\r\n\r\n    # Joint state publisher (for visualization)\r\n    joint_state_publisher = Node(\r\n        package='joint_state_publisher',\r\n        executable='joint_state_publisher',\r\n        name='joint_state_publisher',\r\n        output='screen',\r\n        parameters=[{'use_sim_time': True}]\r\n    )\r\n\r\n    return LaunchDescription([\r\n        gazebo,\r\n        robot_state_publisher,\r\n        joint_state_publisher,\r\n        spawn_entity\r\n    ])\n"})}),"\n",(0,s.jsx)(e.h3,{id:"creating-a-ros-2-node-for-robot-control",children:"Creating a ROS 2 Node for Robot Control"}),"\n",(0,s.jsx)(e.p,{children:"Let's create a simple controller node that can drive the robot:"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Create a controller node (robot_controller/robot_controller/gazebo_controller.py):"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'#!/usr/bin/env python3\r\n\r\n"""\r\nSimple controller for Gazebo simulation.\r\n"""\r\n\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom geometry_msgs.msg import Twist\r\nfrom sensor_msgs.msg import LaserScan\r\nfrom nav_msgs.msg import Odometry\r\n\r\n\r\nclass GazeboController(Node):\r\n    """\r\n    A simple controller for the simulated robot.\r\n    """\r\n\r\n    def __init__(self):\r\n        super().__init__(\'gazebo_controller\')\r\n\r\n        # Create publisher for velocity commands\r\n        self.cmd_vel_publisher = self.create_publisher(\r\n            Twist,\r\n            \'/cmd_vel\',\r\n            10)\r\n\r\n        # Create subscriber for laser scan data\r\n        self.scan_subscriber = self.create_subscription(\r\n            LaserScan,\r\n            \'/scan\',\r\n            self.scan_callback,\r\n            10)\r\n\r\n        # Create subscriber for odometry\r\n        self.odom_subscriber = self.create_subscription(\r\n            Odometry,\r\n            \'/odom\',\r\n            self.odom_callback,\r\n            10)\r\n\r\n        # Timer for control loop\r\n        self.timer = self.create_timer(0.1, self.control_loop)\r\n\r\n        # Robot state\r\n        self.scan_data = None\r\n        self.odom_data = None\r\n        self.obstacle_detected = False\r\n\r\n        self.get_logger().info(\'Gazebo controller initialized\')\r\n\r\n    def scan_callback(self, msg):\r\n        """Callback for laser scan data."""\r\n        self.scan_data = msg\r\n        # Simple obstacle detection: check if anything is closer than 1 meter\r\n        if min(msg.ranges) < 1.0:\r\n            self.obstacle_detected = True\r\n        else:\r\n            self.obstacle_detected = False\r\n\r\n    def odom_callback(self, msg):\r\n        """Callback for odometry data."""\r\n        self.odom_data = msg\r\n\r\n    def control_loop(self):\r\n        """Main control loop."""\r\n        msg = Twist()\r\n\r\n        if self.obstacle_detected:\r\n            # Stop and turn if obstacle detected\r\n            msg.linear.x = 0.0\r\n            msg.angular.z = 0.5  # Turn right\r\n        else:\r\n            # Move forward if no obstacle\r\n            msg.linear.x = 0.5\r\n            msg.angular.z = 0.0\r\n\r\n        self.cmd_vel_publisher.publish(msg)\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    controller = GazeboController()\r\n\r\n    try:\r\n        rclpy.spin(controller)\r\n    except KeyboardInterrupt:\r\n        controller.get_logger().info(\'Controller stopped by user\')\r\n    finally:\r\n        controller.destroy_node()\r\n        rclpy.shutdown()\r\n\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),"\n",(0,s.jsx)(e.h3,{id:"creating-a-urdf-directory-and-adding-your-robot",children:"Creating a URDF Directory and Adding Your Robot"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src/robot_controller/urdf\n"})}),"\n",(0,s.jsxs)(e.p,{children:["Save your URDF file as ",(0,s.jsx)(e.code,{children:"~/ros2_ws/src/robot_controller/urdf/simple_robot.urdf"})]}),"\n",(0,s.jsx)(e.h3,{id:"updating-packagexml",children:"Updating package.xml"}),"\n",(0,s.jsxs)(e.p,{children:["Add dependencies to your ",(0,s.jsx)(e.code,{children:"package.xml"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"<depend>geometry_msgs</depend>\r\n<depend>sensor_msgs</depend>\r\n<depend>nav_msgs</depend>\r\n<depend>ros_gz_sim</depend>\r\n<depend>ros_gz_interfaces</depend>\r\n<depend>robot_state_publisher</depend>\r\n<depend>joint_state_publisher</depend>\n"})}),"\n",(0,s.jsx)(e.h2,{id:"testing--verification",children:"Testing & Verification"}),"\n",(0,s.jsx)(e.h3,{id:"running-the-simulation",children:"Running the Simulation"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Build your package:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"cd ~/ros2_ws\r\ncolcon build --packages-select robot_controller\r\nsource install/setup.bash\n"})}),"\n",(0,s.jsxs)(e.ol,{start:"2",children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Start Gazebo with your robot:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Terminal 1: Start Gazebo\r\nros2 launch robot_controller gazebo_simulation.launch.py\n"})}),"\n",(0,s.jsxs)(e.ol,{start:"3",children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"In another terminal, run the controller:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ros2 run robot_controller gazebo_controller\n"})}),"\n",(0,s.jsxs)(e.ol,{start:"4",children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Or send manual commands:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# Terminal 3: Send velocity commands\r\nros2 topic pub /cmd_vel geometry_msgs/msg/Twist '{linear: {x: 0.5}, angular: {z: 0.2}}'\n"})}),"\n",(0,s.jsx)(e.h3,{id:"useful-gazebo-commands",children:"Useful Gazebo Commands"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"List Gazebo services:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"gz service -s\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Get world information:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"gz service -s /gazebo/worlds --req-type gz.msgs.Empty --rep-type gz.msgs.StringMsg_V\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Get model information:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"gz topic -e -t /world/empty/model/status\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Spawn a model:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"gz service -s /world/empty/create --req-type gz.msgs.EntityFactory --req 'sdf_filename: \"model://cylinder\"'\n"})}),"\n",(0,s.jsx)(e.h3,{id:"ros-2-integration-commands",children:"ROS 2 Integration Commands"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"List topics published by Gazebo:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ros2 topic list | grep gz\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Echo sensor data:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ros2 topic echo /scan sensor_msgs/msg/LaserScan\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:"Check TF tree:"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"ros2 run tf2_tools view_frames\n"})}),"\n",(0,s.jsx)(e.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,s.jsx)(e.h3,{id:"issue-gazebo-doesnt-start-or-crashes",children:"Issue: Gazebo doesn't start or crashes"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Check if your graphics drivers are properly installed"}),"\n",(0,s.jsxs)(e.li,{children:["Try running with software rendering: ",(0,s.jsx)(e.code,{children:"MESA_GL_VERSION_OVERRIDE=3.3 gz sim"})]}),"\n",(0,s.jsx)(e.li,{children:"Ensure sufficient system resources (RAM, GPU)"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"issue-robot-doesnt-appear-in-gazebo",children:"Issue: Robot doesn't appear in Gazebo"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Verify the URDF/SDF file is correctly formatted"}),"\n",(0,s.jsxs)(e.li,{children:["Check that the robot model is being published to ",(0,s.jsx)(e.code,{children:"/robot_description"})]}),"\n",(0,s.jsx)(e.li,{children:"Ensure the spawn command has correct parameters"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"issue-no-sensor-data-from-gazebo",children:"Issue: No sensor data from Gazebo"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Check that sensor plugins are properly configured in URDF/SDF"}),"\n",(0,s.jsx)(e.li,{children:"Verify Gazebo ROS bridge is running"}),"\n",(0,s.jsx)(e.li,{children:"Check topic names match between simulation and code"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"issue-robot-control-not-working",children:"Issue: Robot control not working"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Verify topic names match between controller and Gazebo"}),"\n",(0,s.jsx)(e.li,{children:"Check that the robot has the correct joint names"}),"\n",(0,s.jsx)(e.li,{children:"Ensure the control plugin is properly configured"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Gazebo provides a realistic 3D simulation environment for robotics"}),"\n",(0,s.jsx)(e.li,{children:"Integration with ROS 2 allows seamless communication between simulation and code"}),"\n",(0,s.jsx)(e.li,{children:"Creating custom worlds and robots enhances testing capabilities"}),"\n",(0,s.jsx)(e.li,{children:"Sensor simulation allows for realistic testing of perception algorithms"}),"\n",(0,s.jsx)(e.li,{children:"Simulation is crucial for safe and cost-effective robotics development"}),"\n",(0,s.jsx)(e.li,{children:"Proper URDF/SDF models are essential for accurate simulation"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(e.p,{children:"In the next chapter, you'll learn about Unity integration for robotics simulation, which provides an alternative simulation environment with advanced graphics capabilities."})]})}function h(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},7074:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>a});var i=r(6540);const s={},o=i.createContext(s);function l(n){const e=i.useContext(o);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),i.createElement(o.Provider,{value:e},n.children)}}}]);